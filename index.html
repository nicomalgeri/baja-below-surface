<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Below Surface - Marine Adventures</title>
<link rel="stylesheet" href="assets/css/main.css?v=3">
  
<style>
  
  <!-- Preload critical resources -->
  <link rel="preconnect" href="https://bajabelowsurface.com">
  <link rel="preload" href="https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video.mov" as="video" type="video/mp4">
  
    /* ========================================
       üé® DESIGN SYSTEM & CSS CUSTOM PROPERTIES
       ======================================== */
    :root {
      /* Colors */
      --bs-primary: #f6e7b0;
      --bs-secondary: #d2d7db;
      --bs-dark: #0c1418;
      --bs-bg-dark: #0f1a26;
      --bs-text-light: #e7eef1;
      --bs-text-muted: #dfe7eb;
      
      /* Glass morphism */
      --bs-glass-primary: rgba(13,24,30,.72);
      --bs-glass-secondary: rgba(13,24,30,.55);
      --bs-glass-border: rgba(255,255,255,.08);
      --bs-glass-blur: 18px;
      
      /* Spacing */
      --bs-radius-sm: 16px;
      --bs-radius-md: 24px;
      --bs-radius-lg: 32px;
      --bs-radius-xl: 40px;
      --bs-gap-sm: clamp(1rem,2vw,1.5rem);
      --bs-gap-md: clamp(1.5rem,3vw,2.5rem);
      --bs-gap-lg: clamp(2rem,4vw,4rem);
      
      /* Animations */
      --bs-duration-fast: .25s;
      --bs-duration-normal: .5s;
      --bs-duration-slow: .8s;
      --bs-easing: cubic-bezier(.25,.8,.3,1);
      
      /* Float animation */
      --bs-float-distance: 42px;
      --bs-float-angle: 5deg;
      --bs-float-scale: 1.024;
      --bs-float-duration: 14s;
      
      /* Shadows */
      --bs-shadow-sm: 0 2px 8px -2px rgba(0,0,0,.3);
      --bs-shadow-md: 0 8px 28px -10px rgba(0,0,0,.55);
      --bs-shadow-lg: 0 22px 48px -18px rgba(0,0,0,.6), 0 6px 16px -6px rgba(0,0,0,.45);
      --bs-shadow-glow: 0 10px 26px rgba(33,38,45,.4);
    }

    /* ========================================
       üîß RESET & BASE STYLES
       ======================================== */
    .bs-container * {
      box-sizing: border-box;
    }
    
    .bs-container {
      position: relative;
      width: 100vw;
      left: 50%;
      right: 50%;
      margin-left: -50vw;
      margin-right: -50vw;
      padding: 0 !important;
      border: 0 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bs-bg-dark);
      color: var(--bs-text-light);
      scroll-behavior: smooth;
      overflow-x: hidden;
      isolation: isolate;
    }

    /* Elementor compatibility - reset inherited styles */
    .bs-container .elementor-widget-container,
    .bs-container .elementor-element,
    .bs-container .elementor-column,
    .bs-container .elementor-row {
      margin: 0 !important;
      padding: 0 !important;
      background: transparent !important;
    }

    /* ========================================
       üé¨ HERO VIDEO SECTION
       ======================================== */
    .bs-hero-wrapper {
      position: relative;
      width: 100vw;
      left: 50%;
      right: 50%;
      margin-left: -50vw;
      margin-right: -50vw;
      overflow: hidden;
      isolation: isolate;
    }

    .bs-hero-video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      pointer-events: none;
      z-index: 0;
      filter: brightness(.85) saturate(1.1);
    }

    .bs-hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        180deg,
        rgba(0,0,0,.70) 0%,
        rgba(0,0,0,.50) 16%,
        rgba(0,0,0,.30) 34%,
        rgba(0,0,0,.18) 52%,
        rgba(0,0,0,.12) 64%,
        rgba(0,0,0,.10) 72%,
        rgba(0,0,0,.08) 85%,
        rgba(0,0,0,.10) 100%
      );
      z-index: 1;
      pointer-events: none;
    }

    /* ========================================
       ü¶∏ HERO CONTENT
       ======================================== */
    .bs-hero {
      position: relative;
      width: 100%;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      z-index: 2;
    }

    .bs-hero__content {
      position: relative;
      z-index: 2;
      width: 100%;
      max-width: 1280px;
      margin: 0 auto;
      text-align: center;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .bs-hero__text {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: min(1000px, 92vw);
      margin: 0;
      font: 700 clamp(1.2rem, 1.6vw + 1rem, 2.2rem) / 1.25 inherit;
      color: var(--bs-primary);
      opacity: 0;
      text-align: center;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-wrap: balance;
      animation: bs-fade-text 10s infinite;
      pointer-events: none;
    }

    .bs-hero__text--2 {
      animation-delay: 5s;
    }

    @keyframes bs-fade-text {
      0%, 50%, 100% { opacity: 0; }
      8%, 40% { opacity: 1; }
    }

    .bs-hero__scroll {
      position: absolute;
      left: 50%;
      bottom: clamp(16px, 3vh, 32px);
      transform: translateX(-50%);
      width: clamp(44px, 8vw, 52px);
      height: clamp(44px, 8vw, 52px);
      background: rgba(255,255,255,.05);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 3;
      transition: all var(--bs-duration-fast) var(--bs-easing);
      animation: bs-bounce 2s infinite;
      border: none;
      text-decoration: none;
    }

    .bs-hero__scroll:hover {
      background: rgba(33,38,45,.8);
      box-shadow: var(--bs-shadow-glow);
      transform: translateX(-50%) translateY(-4px);
    }

    .bs-hero__scroll svg {
      width: 20px;
      height: 20px;
      stroke: var(--bs-primary);
      stroke-width: 2;
      fill: none;
      transition: transform var(--bs-duration-fast) ease;
    }

    @keyframes bs-bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
      40% { transform: translateX(-50%) translateY(8px); }
      60% { transform: translateX(-50%) translateY(4px); }
    }

    /* ========================================
       üõ†Ô∏è SERVICES SECTION
       ======================================== */
     .bs-services {
       position: relative;
       z-index: 2;
       width: 100vw;
       left: 50%;
       right: 50%;
       margin-left: -50vw;
       margin-right: -50vw;
       padding: var(--bs-gap-lg) var(--bs-gap-md);
       background: transparent;
       display: flex;
       justify-content: center;
     }

    .bs-services__grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: var(--bs-gap-md);
      width: 100%;
      max-width: 1280px;
      margin: 0 auto;
      padding: 2.5rem var(--bs-gap-md) 3rem;
      border-radius: var(--bs-radius-xl);
      background: linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.01));
      backdrop-filter: blur(var(--bs-glass-blur)) saturate(1.45);
      -webkit-backdrop-filter: blur(var(--bs-glass-blur)) saturate(1.45);
      box-shadow: var(--bs-shadow-lg), inset 0 0 0 1px rgba(255,255,255,.06);
    }

    .bs-service-card {
      position: relative;
      flex: 1 1 0;
      min-width: 280px;
      max-width: 360px;
      aspect-ratio: 4/5;
      border-radius: var(--bs-radius-md);
      overflow: hidden;
      background: var(--bs-bg-dark);
      cursor: pointer;
      box-shadow: var(--bs-shadow-md);
      transform: translateZ(0);
      animation: bs-float var(--bs-float-duration) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
      transition: all var(--bs-duration-normal) var(--bs-easing);
    }

    @keyframes bs-float {
      0%, 100% { transform: translateY(0) rotate(0) scale(1); }
      20% { 
        transform: translateY(calc(var(--bs-float-distance) * -0.35)) 
                   rotate(calc(var(--bs-float-angle) * -0.4)) 
                   scale(var(--bs-float-scale)); 
      }
      40% { 
        transform: translateY(calc(var(--bs-float-distance) * -0.85)) 
                   rotate(calc(var(--bs-float-angle) * -1)) 
                   scale(1); 
      }
      60% { 
        transform: translateY(calc(var(--bs-float-distance) * -0.5)) 
                   rotate(calc(var(--bs-float-angle) * 0.6)) 
                   scale(var(--bs-float-scale)); 
      }
      80% { 
        transform: translateY(calc(var(--bs-float-distance) * -0.18)) 
                   rotate(calc(var(--bs-float-angle) * 0.25)) 
                   scale(1); 
      }
    }

    .bs-service-card__media {
      position: absolute;
      inset: 0;
      background: var(--img) center/cover no-repeat;
      filter: brightness(.92) saturate(1.08);
      transition: filter var(--bs-duration-slow) ease, transform var(--bs-duration-slow) ease;
      z-index: 0;
    }

    .bs-service-card__content {
      position: absolute;
      inset: 0;
      z-index: 2;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      background: linear-gradient(180deg, rgba(0,0,0,0) 36%, rgba(6,10,14,.88) 100%);
      padding: 1.2rem 1.4rem 1.3rem;
    }

    .bs-service-card__title {
      margin: 0 0 .5rem;
      font-size: clamp(1.1rem, .9vw + .85rem, 1.6rem);
      font-weight: 700;
      letter-spacing: .5px;
      color: var(--bs-primary);
      text-shadow: 0 2px 6px rgba(0,0,0,.55);
    }

    .bs-service-card__details {
      transform: translateY(120%);
      opacity: 0;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1rem;
      transition: transform var(--bs-duration-normal) var(--bs-easing), 
                  opacity var(--bs-duration-normal) var(--bs-easing);
    }

    .bs-service-card__text {
      margin: 0;
      font-size: .9rem;
      line-height: 1.5;
      letter-spacing: .3px;
      color: var(--bs-secondary);
      flex: 1;
    }

    .bs-service-card__cta {
      position: relative;
      background: rgba(255,255,255,0.08);
      border: none;
      width: 52px;
      height: 52px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--bs-duration-fast) ease;
      color: var(--bs-primary);
      flex-shrink: 0;
      overflow: hidden;
    }

    .bs-service-card__cta svg {
      width: 22px;
      height: 22px;
      display: block;
      transition: transform var(--bs-duration-fast) ease;
    }

    .bs-service-card__cta:hover {
      background: rgba(33,38,45,.9);
      transform: scale(1.1);
      box-shadow: var(--bs-shadow-glow);
    }

    .bs-service-card__cta:hover svg {
      transform: translateX(2px) scale(1.1);
    }

    .bs-service-card:is(:hover, :focus-within) {
      animation-play-state: paused !important;
      box-shadow: 0 28px 56px -20px rgba(0,0,0,.85);
    }

    .bs-service-card:is(:hover, :focus-within) .bs-service-card__media {
      filter: brightness(.55) saturate(1.05) blur(6px);
      transform: scale(1.08);
    }

    .bs-service-card:is(:hover, :focus-within) .bs-service-card__details {
      transform: translateY(0);
      opacity: 1;
    }

    /* ========================================
       üì± RESPONSIVE DESIGN
       ======================================== */
    @media (max-width: 1100px) {
      .bs-service-card {
        max-width: 100%;
        aspect-ratio: 5/4;
      }
    }

    @media (max-width: 768px) {
      .bs-hero__text {
        font-size: clamp(1rem, 4.6vw, 1.5rem);
      }
      
      .bs-hero__scroll {
        bottom: 24px;
        width: 44px;
        height: 44px;
      }
      
      .bs-services {
        padding: var(--bs-gap-md) 1rem;
      }
      
      .bs-services__grid {
        padding: 2rem 1.5rem 2.5rem;
      }
    }

    /* ========================================
       ‚ôø ACCESSIBILITY & REDUCED MOTION
       ======================================== */
    @media (prefers-reduced-motion: reduce) {
      .bs-service-card,
      .bs-hero__text {
        animation: none !important;
        transform: none !important;
      }
      
      .bs-hero__scroll {
        animation: none;
      }
      
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Focus indicators for accessibility */
    .bs-service-card:focus-within,
    .bs-hero__scroll:focus {
      outline: 2px solid var(--bs-primary);
      outline-offset: 4px;
    }

    .bs-service-card__cta:focus {
      outline: 2px solid var(--bs-primary);
      outline-offset: 3px;
    }

    /* ========================================
       üé≠ UTILITY CLASSES
       ======================================== */
    .bs-sr-only {
      position: absolute !important;
      width: 1px !important;
      height: 1px !important;
      padding: 0 !important;
      margin: -1px !important;
      overflow: hidden !important;
      clip: rect(0, 0, 0, 0) !important;
      white-space: nowrap !important;
      border: 0 !important;
    }

    .bs-loading {
      opacity: 0;
      transition: opacity var(--bs-duration-normal) ease;
    }

    .bs-loaded {
      opacity: 1;
    }
  </style>
</head>

<body>
  <div class="bs-container">
    <div class="bs-hero-wrapper">
      <!-- Video Background -->
      <video 
        id="bsMainVideo" 
        class="bs-hero-video" 
        autoplay 
        muted 
        loop 
        playsinline
        preload="metadata"
        aria-hidden="true"
      >
        <source src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video.mov" type="video/mp4">
        <div class="bs-sr-only">Your browser does not support the video tag.</div>
      </video>
      
      <div class="bs-hero-overlay" aria-hidden="true"></div>

      <!-- Hero Section -->
      <header class="bs-hero" id="bsTop" role="banner">
        <div class="bs-hero__content">
          <h1 class="bs-hero__text bs-hero__text--1">
            Unlock The Underwater Mysteries
          </h1>
          <h1 class="bs-hero__text bs-hero__text--2" aria-hidden="true">
            Join Us for an Experience Where the Hidden Depths Come to Life
          </h1>
          
          <a 
            href="#bsServices" 
            class="bs-hero__scroll" 
            aria-label="Scroll to Services section"
            role="button"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <polyline points="6 9 12 15 18 9" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="bs-sr-only">Scroll to Services</span>
          </a>
        </div>
      </header>

      <!-- Services Section -->
      <section class="bs-services" id="bsServices" aria-labelledby="bsServicesHeading">
        <h2 id="bsServicesHeading" class="bs-sr-only">Our Marine Adventure Services</h2>
        
        <div class="bs-services__grid" role="list">
          <!-- Day Trips -->
          <article 
            class="bs-service-card bs-loading" 
            style="--delay: 0s; --img: url('https://bajabelowsurface.com/wp-content/uploads/2025/07/WhatsApp-Image-2025-07-08-at-05.59.56-scaled.jpeg')"
            role="listitem"
            data-url="https://bajabelowsurface.com/?page_id=1215"
          >
            <div class="bs-service-card__media" aria-hidden="true"></div>
            <div class="bs-service-card__content">
              <h3 class="bs-service-card__title">Day Trips</h3>
              <div class="bs-service-card__details">
                <p class="bs-service-card__text">
                  Single-day marine adventures: reefs, wildlife encounters &amp; expert guides.
                </p>
                <button 
                  class="bs-service-card__cta" 
                  aria-label="Learn more about Day Trips"
                  data-service="day-trips"
                >
                  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M12 2l-1.41 1.41L16.17 9H4v2h12.17l-5.58 5.59L12 18l8-8z"/>
                  </svg>
                </button>
              </div>
            </div>
          </article>

          <!-- Expeditions -->
          <article 
            class="bs-service-card bs-loading" 
            style="--delay: .45s; --img: url('https://bajabelowsurface.com/wp-content/uploads/2025/07/WhatsApp-Image-2025-07-08-at-06.00.23-scaled.jpeg')"
            role="listitem"
            data-url="https://bajabelowsurface.com/?page_id=1384"
          >
            <div class="bs-service-card__media" aria-hidden="true"></div>
            <div class="bs-service-card__content">
              <h3 class="bs-service-card__title">Expeditions</h3>
              <div class="bs-service-card__details">
                <p class="bs-service-card__text">
                  Multi-day remote exploration, research support &amp; immersive learning.
                </p>
                <button 
                  class="bs-service-card__cta" 
                  aria-label="Learn more about Expeditions"
                  data-service="expeditions"
                >
                  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M12 2l-1.41 1.41L16.17 9H4v2h12.17l-5.58 5.59L12 18l8-8z"/>
                  </svg>
                </button>
              </div>
            </div>
          </article>

          <!-- Charter -->
          <article 
            class="bs-service-card bs-loading" 
            style="--delay: .9s; --img: url('https://bajabelowsurface.com/wp-content/uploads/2025/07/WhatsApp-Image-2025-07-08-at-06.00.36.jpeg')"
            role="listitem"
            data-url="https://bajabelowsurface.com/?page_id=1386"
          >
            <div class="bs-service-card__media" aria-hidden="true"></div>
            <div class="bs-service-card__content">
              <h3 class="bs-service-card__title">Charter</h3>
              <div class="bs-service-card__details">
                <p class="bs-service-card__text">
                  Private vessel, bespoke itinerary, full crew &amp; logistics handled.
                </p>
                <button 
                  class="bs-service-card__cta" 
                  aria-label="Learn more about Charter services"
                  data-service="charter"
                >
                  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M12 2l-1.41 1.41L16.17 9H4v2h12.17l-5.58 5.59L12 18l8-8z"/>
                  </svg>
                </button>
              </div>
            </div>
          </article>
        </div>
      </section>
    </div>
  </div>

  <script>
    /**
     * Below Surface - Enhanced JavaScript Module
     * Optimized for WordPress/Elementor compatibility
     */
    (function() {
      'use strict';
      
      // Performance and error handling utilities
      const BSUtils = {
        // Debounce function for performance
        debounce: function(func, wait) {
          let timeout;
          return function executedFunction(...args) {
            const later = () => {
              clearTimeout(timeout);
              func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
          };
        },

        // Safe DOM query with error handling
        safeQuery: function(selector, context = document) {
          try {
            return context.querySelector(selector);
          } catch (e) {
            console.warn(`BS: Invalid selector "${selector}":`, e);
            return null;
          }
        },

        // Check if element is in viewport
        isInViewport: function(element) {
          if (!element) return false;
          const rect = element.getBoundingClientRect();
          return (
            rect.top >= 0 &&
            rect.left >= 0 &&
            rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
            rect.right <= (window.innerWidth || document.documentElement.clientWidth)
          );
        },

        // Smooth scroll with fallback
        smoothScroll: function(target) {
          if (target) {
            if ('scrollBehavior' in document.documentElement.style) {
              target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
              // Fallback for older browsers
              const targetPosition = target.offsetTop;
              window.scrollTo({
                top: targetPosition,
                behavior: 'smooth'
              });
            }
          }
        }
      };

      // Video Management Module
      const VideoManager = {
        init: function() {
          this.video = BSUtils.safeQuery('#bsMainVideo');
          if (!this.video) return;

          this.setupResponsiveVideo();
          this.setupVideoErrorHandling();
          
          // Resize listener with debouncing
          window.addEventListener('resize', BSUtils.debounce(this.setupResponsiveVideo.bind(this), 250));
        },

        setupResponsiveVideo: function() {
          if (!this.video) return;

          const desktopSrc = 'https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video-1.mov';
          const mobileSrc = 'https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video.mov';
          const isMobile = window.innerWidth < 768;
          const targetSrc = isMobile ? mobileSrc : desktopSrc;
          
          const currentSource = this.video.querySelector('source');
          if (currentSource && currentSource.getAttribute('src') === targetSrc) {
            return; // Source is already correct
          }

          this.video.pause();
          this.video.innerHTML = '';
          
          const newSource = document.createElement('source');
          newSource.src = targetSrc;
          newSource.type = 'video/mp4';
          
          this.video.appendChild(newSource);
          this.video.load();
          
          // Auto-play with error handling
          const playPromise = this.video.play();
          if (playPromise !== undefined) {
            playPromise.catch(error => {
              console.warn('BS: Video autoplay failed:', error);
              // Video autoplay was prevented, which is normal on some devices
            });
          }
        },

        setupVideoErrorHandling: function() {
          if (!this.video) return;

          this.video.addEventListener('error', (e) => {
            console.error('BS: Video error:', e);
            // Hide video overlay on error to prevent black screen
            const overlay = BSUtils.safeQuery('.bs-hero-overlay');
            if (overlay) {
              overlay.style.opacity = '0.9';
            }
          });

          this.video.addEventListener('loadeddata', () => {
            console.log('BS: Video loaded successfully');
          });
        }
      };

      // Service Cards Module
      const ServiceCards = {
        init: function() {
          this.cards = document.querySelectorAll('.bs-service-card');
          this.setupClickHandlers();
          this.setupKeyboardNavigation();
          this.setupIntersectionObserver();
        },

        setupClickHandlers: function() {
          this.cards.forEach(card => {
            const button = card.querySelector('.bs-service-card__cta');
            const url = card.dataset.url;
            
            if (button && url) {
              button.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                this.handleServiceClick(button, url);
              });

              // Also handle card click
              card.addEventListener('click', (e) => {
                if (e.target === button || button.contains(e.target)) return;
                this.handleServiceClick(button, url);
              });
            }
          });
        },

        setupKeyboardNavigation: function() {
          this.cards.forEach(card => {
            card.setAttribute('tabindex', '0');
            
            card.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                const url = card.dataset.url;
                if (url) {
                  const button = card.querySelector('.bs-service-card__cta');
                  this.handleServiceClick(button, url);
                }
              }
            });
          });
        },

        setupIntersectionObserver: function() {
          if (!('IntersectionObserver' in window)) {
            // Fallback: just add loaded class to all cards
            this.cards.forEach(card => card.classList.add('bs-loaded'));
            return;
          }

          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                entry.target.classList.add('bs-loaded');
                observer.unobserve(entry.target);
              }
            });
          }, {
            rootMargin: '50px',
            threshold: 0.1
          });

          this.cards.forEach(card => observer.observe(card));
        },

        handleServiceClick: function(button, url) {
          if (!button || !url) return;

          // Visual feedback
          this.createRippleEffect(button);
          
          // Track analytics if available
          if (typeof gtag === 'function') {
            gtag('event', 'service_click', {
              'service_type': button.dataset.service || 'unknown',
              'destination_url': url
            });
          }

          // Navigate after brief delay for visual feedback
          setTimeout(() => {
            window.location.href = url;
          }, 200);
        },

        createRippleEffect: function(button) {
          const existingRipple = button.querySelector('.bs-ripple');
          if (existingRipple) {
            existingRipple.remove();
          }

          const ripple = document.createElement('span');
          ripple.className = 'bs-ripple';
          ripple.style.cssText = `
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            background: rgba(246,231,176,.25);
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            transform: scale(0);
            opacity: 0.4;
            transition: none;
          `;

          button.appendChild(ripple);

          requestAnimationFrame(() => {
            ripple.style.transition = 'transform 0.6s ease-out, opacity 0.6s ease-out';
            ripple.style.transform = 'scale(1.8)';
            ripple.style.opacity = '0';
          });

          // Clean up ripple element
          setTimeout(() => {
            if (ripple.parentNode) {
              ripple.parentNode.removeChild(ripple);
            }
          }, 600);
        }
      };

      // Navigation Module
      const Navigation = {
        init: function() {
          this.setupScrollButton();
          this.setupSmoothScrolling();
        },

        setupScrollButton: function() {
          const scrollButton = BSUtils.safeQuery('.bs-hero__scroll');
          if (!scrollButton) return;

          scrollButton.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = scrollButton.getAttribute('href');
            const target = BSUtils.safeQuery(targetId);
            
            if (target) {
              BSUtils.smoothScroll(target);
              
              // Focus target for accessibility
              setTimeout(() => {
                target.setAttribute('tabindex', '-1');
                target.focus();
              }, 500);
            }
          });
        },

        setupSmoothScrolling: function() {
          // Handle any internal links with smooth scrolling
          const internalLinks = document.querySelectorAll('a[href^="#bs"]');
          
          internalLinks.forEach(link => {
            link.addEventListener('click', (e) => {
              e.preventDefault();
              const targetId = link.getAttribute('href');
              const target = BSUtils.safeQuery(targetId);
              
              if (target) {
                BSUtils.smoothScroll(target);
              }
            });
          });
        }
      };

      // Error Handling Module
      const ErrorHandler = {
        init: function() {
          window.addEventListener('error', this.handleError);
          window.addEventListener('unhandledrejection', this.handlePromiseRejection);
        },

        handleError: function(event) {
          console.error('BS: Runtime error:', event.error);
          // Don't break the entire page for individual component errors
        },

        handlePromiseRejection: function(event) {
          console.error('BS: Promise rejection:', event.reason);
          // Prevent unhandled promise rejections from breaking the page
          event.preventDefault();
        }
      };

      // Main Initialization
      const BelowSurface = {
        init: function() {
          try {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
              document.addEventListener('DOMContentLoaded', () => this.bootstrap());
            } else {
              this.bootstrap();
            }
          } catch (error) {
            console.error('BS: Initialization failed:', error);
          }
        },

        bootstrap: function() {
          console.log('BS: Initializing Below Surface components...');
          
          // Initialize error handling first
          ErrorHandler.init();
          
          // Initialize all modules
          VideoManager.init();
          ServiceCards.init();
          Navigation.init();
          
          // Mark as initialized
          document.body.classList.add('bs-initialized');
          
          console.log('BS: Initialization complete');
        }
      };

      // Auto-initialize
      BelowSurface.init();

      // Expose for external use if needed
      window.BelowSurface = BelowSurface;
      
    })();
  </script>
</body>
</html>
<!-- ============ ABOUT (FULL-WIDTH, FLOATING GLASS PANELS) ============ -->
<style>
  :root{
    --highlight:#f6e7b0;
    --ink:#0c1418;
    --glass1:rgba(13,24,30,.72);
    --glass2:rgba(13,24,30,.55);
    --stroke:rgba(255,255,255,.08);
    --text:#e7eef1;
    --shadow:0 22px 48px -18px rgba(0,0,0,.6), 0 6px 16px -6px rgba(0,0,0,.45);
  }

  /* Make this section truly full-bleed, even inside a boxed Elementor container */
  .about{
    position:relative;
    width:100vw;               /* full viewport width */
    left:50%;                  /* center the breakout */
    margin-left:-50vw;         /* pull left by half viewport */
    right:50%;
    margin-right:-50vw;        /* pull right by half viewport (robust on nested cols) */
    padding:clamp(3.5rem,8vh,5.5rem) clamp(1rem,4vw,4rem);
    overflow:hidden;
    color:#fff;
    isolation:isolate;
    z-index:0;
  }
  /* helpful when Elementor columns/widgets try to clip overflow */
  .about *{overflow:visible;}

  /* Background image with a lighter overlay (less dark than before) */
  .about::before{
    content:"";
    position:absolute; inset:0; z-index:-2;
    background:
      radial-gradient(60% 90% at 10% 0%, rgba(0,0,0,.18), transparent 60%),
      radial-gradient(70% 100% at 90% 100%, rgba(0,0,0,.25), transparent 62%),
      url('https://bajabelowsurface.com/wp-content/uploads/2025/07/Sea-Lion-Snorkel.avif') center/cover no-repeat;
    filter:saturate(1.06) brightness(.98);
  }
  .about::after{
    content:"";
    position:absolute; inset:0; z-index:-1;
    background:linear-gradient(180deg, rgba(0,0,0,.06), rgba(0,0,0,.18) 55%, rgba(0,0,0,.22));
  }

  .about__wrap{
    max-width:1240px;
    margin-inline:auto;
    display:grid;
    grid-template-columns: 1fr 1.1fr;
    gap:clamp(1.6rem,3vw,3rem);
    align-items:center;
    justify-items:center;
  }

  @keyframes floatSoft{
    0%,100%{transform:translateY(0) rotate(0.1deg);}
    50%{transform:translateY(-14px) rotate(-0.2deg);}
  }

  /* LEFT: square image panel */
  .about__media{
    width:clamp(280px,34vw,420px);
    aspect-ratio:1/1;
    border-radius:28px;
    overflow:hidden;
    box-shadow:var(--shadow);
    outline:1px solid var(--stroke);
    background:#000;
    animation:floatSoft 12s ease-in-out infinite;
    animation-delay:.4s;
  }
  .about__media img{
    width:100%; height:100%;
    object-fit:cover; object-position:center;
    filter:saturate(1.02) contrast(1.02);
    transform:scale(1.02);
    display:block;
  }

  /* RIGHT: glass content panel (matches contact panel look) */
  .about__panel{
    position:relative;
    width:100%;
    border-radius:28px;
    padding:clamp(1.6rem,2.8vw,2.6rem) clamp(1.6rem,3vw,3rem);
    background:linear-gradient(135deg, var(--glass1), var(--glass2));
    outline:1px solid var(--stroke);
    box-shadow:var(--shadow), inset 0 0 0 1px rgba(255,255,255,.05);
    backdrop-filter:blur(18px) saturate(1.35);
    -webkit-backdrop-filter:blur(18px) saturate(1.35);
    color:var(--text);
    animation:floatSoft 14s ease-in-out infinite;
  }
  .about__panel::after{
    content:"";
    position:absolute; inset:0; border-radius:28px; pointer-events:none;
    box-shadow:inset 0 0 0 1px rgba(255,255,255,.03);
  }

  .about__heading{
    margin:0 0 .9rem;
    font-weight:800;
    letter-spacing:.4px;
    color:var(--highlight);
    font-size:clamp(1.6rem,1.6vw + 1.2rem,2.3rem);
  }
  .about__text{
    margin:0 0 1rem;
    font-size:clamp(.98rem,.25vw + .98rem,1.05rem);
    line-height:1.65;
    color:#dfe7eb;
  }

  /* Button styled like the ‚ÄúSend Message‚Äù pill */
  .about__btn{
    display:inline-block;
    margin-top:1.1rem;
    padding:.95rem 1.6rem;
    border-radius:999px;
    font-weight:800;
    letter-spacing:.6px;
    text-transform:uppercase;
    text-decoration:none;
    background:rgba(10,15,20,.75);
    color:var(--highlight);
    border:3px solid var(--highlight);
    box-shadow:0 10px 24px -12px rgba(0,0,0,.6), inset 0 0 0 1px rgba(255,255,255,.05);
    transition:transform .25s ease, box-shadow .25s ease, background .25s ease, color .25s ease;
  }
  .about__btn:hover,
  .about__btn:focus{
    background:var(--highlight);
    color:var(--ink);
    transform:translateY(-2px);
    box-shadow:0 16px 34px -14px rgba(0,0,0,.7);
    outline:0;
  }

  /* Responsive */
  @media (max-width:980px){
    .about__wrap{grid-template-columns:1fr; max-width:700px;}
    .about__panel{width:100%;}
    .about__media{order:-1;}
  }
</style>

<section class="about" id="About" aria-label="About Us">
  <div class="about__wrap">
    <figure class="about__media" aria-hidden="true">
      <img src="https://bajabelowsurface.com/wp-content/uploads/2025/08/Untitled-design-2.png" alt="Guide at sea">
    </figure>

    <article class="about__panel">
      <h2 class="about__heading">Get to Know Us</h2>
      <p class="about__text">
        At the heart of our mission lies a simple yet powerful goal: to inspire wonder and foster
        connection through the incredible diversity of marine life that calls the ocean home.
      </p>
      <p class="about__text">
        Every expedition, day trip, and charter blends responsible exploration with authentic local
        insight‚Äîhelping guests experience hidden depths while protecting them for future generations.
      </p>
      <a class="about__btn" href="https://bajabelowsurface.com/?page_id=1397">Read&nbsp;More</a>
    </article>
  </div>
</section>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Below Surface Gallery</title>

  <style>
    :root {
      --bs-highlight: #f6e7b0;
      --bs-shadow: 0 22px 48px -18px rgba(0,0,0,.6), 0 6px 16px -6px rgba(0,0,0,.45);
      --bs-row-height: 78vh;
      --bs-thumb-radius: 20px;
      --bs-gap: 20px;
      --bs-section-padding: 2.5rem; /* controls all vertical spacing */
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      background: #0f1a26;
      color: #fff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      overflow-x: hidden;
    }

    .bs-fullscreen-gallery {
      position: relative;
      width: 100vw;
      min-height: 100vh;
      margin-left: calc(50% - 50vw);
      padding: var(--bs-section-padding) 3vw; /* uniform padding: top/bottom */
      display: flex;
      flex-direction: column;
      align-items: stretch;
      background:
        radial-gradient(60% 90% at 10% 0%, rgba(0,0,0,.15), transparent 60%),
        radial-gradient(70% 100% at 90% 100%, rgba(0,0,0,.2), transparent 62%),
        url('https://bajabelowsurface.com/wp-content/uploads/2025/07/Baitball-Marlin-scaled.jpg') center/cover no-repeat; /* no parallax */
    }

    /* Title */
    .bs-gallery-title {
      text-align: center;
      font-weight: 700;
      font-size: clamp(2rem, 4vw, 3rem);
      color: var(--bs-highlight);
      text-shadow: 0 4px 20px rgba(0,0,0,0.8);
      letter-spacing: -0.02em;
      margin: 0;
      padding: var(--bs-section-padding) 0; /* equal gap above & below */
    }

    /* Gallery block */
    .bs-gallery-column {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--bs-section-padding) 0; /* equal gap above & below */
    }

    .bs-row-wrap {
      position: relative;
      width: 100%;
      height: var(--bs-row-height);
      max-height: 84vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ONE-ROW STRIPE */
    .bs-gallery-row {
      display: flex;
      gap: var(--bs-gap);
      height: 100%;
      overflow-x: auto;                   /* enable horizontal scroll */
      overflow-y: hidden;
      -webkit-overflow-scrolling: touch;  /* iOS momentum */
      scroll-behavior: smooth;            /* smooth for button/programmatic scroll */
      border-radius: 24px;
      /* keep page vertical scroll responsive */
      overscroll-behavior-x: contain;     /* prevent horizontal overscroll bouncing page */
      overscroll-behavior-y: auto;        /* allow normal vertical scroll */
      /* fade edges */
      -webkit-mask-image: linear-gradient(to right, transparent 0, #000 5%, #000 95%, transparent 100%);
      mask-image: linear-gradient(to right, transparent 0, #000 5%, #000 95%, transparent 100%);
      /* hide scrollbars */
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    .bs-gallery-row::-webkit-scrollbar { display: none; }

    .bs-gallery-row img {
      height: 100%;
      width: auto;
      object-fit: cover;
      display: block;
      border-radius: var(--bs-thumb-radius);
      background: #0e1a2c;
      box-shadow: var(--bs-shadow);
      cursor: pointer;
      transition: transform .35s cubic-bezier(.25,.8,.25,1), box-shadow .35s ease;
      user-select: none;
      -webkit-user-drag: none;
      position: relative;
      z-index: 1; /* keep pictures above everything on mobile */
    }

    .bs-gallery-row img:hover {
      transform: scale(1.05);
      box-shadow: var(--bs-shadow), 0 20px 40px -15px rgba(0,0,0,0.8);
    }

    /* Minimal carousel buttons (desktop + mobile) */
    .bs-row-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 52px;
      height: 52px;
      border-radius: 50%;
      border: none;
      background: rgba(0,0,0,0.6);
      color: #fff;
      font-size: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      backdrop-filter: blur(6px);
      transition: transform .2s ease, background .2s ease;
      z-index: 2;
      line-height: 1;
    }
    .bs-row-btn:hover { background: rgba(0,0,0,0.85); transform: translateY(-50%) scale(1.06); }
    .bs-row-prev { left: 0.25rem; }
    .bs-row-next { right: 0.25rem; }

    /* Video block */
    .bs-video-column {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--bs-section-padding) 0; /* equal gap above & below */
    }

    .bs-video-wrapper {
      position: relative;
      width: 100%;
      max-width: 760px;
      aspect-ratio: 16/9;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: var(--bs-shadow);
      background: #000;
    }

    .bs-video-wrapper video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* Lightbox (unchanged) */
    .bs-lightbox {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,.95);
      z-index: 10000;
      padding: 1rem;
      backdrop-filter: blur(8px);
      opacity: 0;
      visibility: hidden;
      transition: opacity .4s cubic-bezier(.25,.8,.25,1), visibility .4s cubic-bezier(.25,.8,.25,1);
    }
    .bs-lightbox.bs-show { display: flex; opacity: 1; visibility: visible; }

    .bs-lightbox-content {
      position: relative;
      max-width: 95%;
      max-height: 95%;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2rem;
    }

    .bs-lightbox-img-wrapper {
      position: relative;
      flex: 1 1 auto;
      max-width: 100%;
      max-height: 100%;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bs-lightbox img {
      display: block;
      max-width: 100%;
      max-height: 90vh;
      border-radius: 16px;
      object-fit: contain;
      transition: transform .4s cubic-bezier(.25,.8,.25,1), opacity .4s cubic-bezier(.25,.8,.25,1);
      transform: scale(.9);
      opacity: 0;
    }
    .bs-lightbox.bs-show img { transform: scale(1); opacity: 1; }

    .bs-close-btn,
    .bs-nav-btn {
      position: absolute;
      border: none;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      cursor: pointer;
      z-index: 10;
      backdrop-filter: blur(8px);
      line-height: 1;
      transition: all .3s ease;
    }

    .bs-close-btn {
      top: 1rem; right: 1rem;
      width: 48px; height: 48px; font-size: 24px;
      background: rgba(0,0,0,.7);
    }
    .bs-close-btn:hover { background: rgba(0,0,0,.9); transform: scale(1.1); }

    .bs-nav-btn {
      top: 50%; transform: translateY(-50%);
      width: 56px; height: 56px; font-size: 24px;
      background: rgba(0,0,0,.7);
    }
    .bs-nav-btn:hover { background: rgba(0,0,0,.9); transform: translateY(-50%) scale(1.1); }
    .bs-prev-btn { left: 1rem; }
    .bs-next-btn { right: 1rem; }

    /* Responsive adjustments */
    @media (max-width: 1100px) {
      .bs-row-wrap { height: 52vh; padding: 0 0.5rem; }
    }
    @media (max-width: 768px) {
      .bs-fullscreen-gallery { padding: var(--bs-section-padding) 1rem; }
      .bs-row-wrap { height: 44vh; }
    }
  </style>
</head>
<body>

<section class="bs-fullscreen-gallery" aria-label="Below Surface Gallery">

  <h1 class="bs-gallery-title">Gallery</h1>

  <div class="bs-gallery-column">
    <div class="bs-row-wrap">
      <!-- DESKTOP: use only buttons; MOBILE/TABLET: native swipe works -->
      <button class="bs-row-btn bs-row-prev" aria-label="Scroll previous" type="button">&#10094;</button>

      <div class="bs-gallery-row" id="bsGalleryRow">
        <!-- ONE STRIPE ONLY ‚Äî NO REPEATS -->
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Scuba-Diving-1.avif" alt="Scuba Diving Adventure" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Sea-Lion-Snorkel-1.avif" alt="Sea Lion Snorkelling" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Sunset-in-Paradise-1.avif" alt="Sunset in Paradise" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Whale-Watching-1.avif" alt="Whale Watching" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Whale-Shark-Snorkel-1.avif" alt="Whale Shark Snorkel" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Sport-Fishing-1.avif" alt="Sport Fishing" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Ocean-Safari-1.avif" alt="Ocean Safari" />
      </div>

      <button class="bs-row-btn bs-row-next" aria-label="Scroll next" type="button">&#10095;</button>
    </div>
  </div>

  <div class="bs-video-column">
    <div class="bs-video-wrapper">
      <video id="bsMainVideo" controls playsinline preload="metadata">
        <source src="https://bajabelowsurface.com/wp-content/uploads/2025/08/Main-Video-1.mov" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
  </div>

</section>

<!-- Lightbox -->
<div class="bs-lightbox" id="bsLightbox">
  <div class="bs-lightbox-content">
    <button class="bs-close-btn" id="bsCloseLightbox" aria-label="Close Gallery">&times;</button>
    <button class="bs-nav-btn bs-prev-btn" id="bsPrevBtn" aria-label="Previous Image">&#10094;</button>
    <div class="bs-lightbox-img-wrapper">
      <img src="" id="bsLightboxImg" alt="Expanded gallery image" draggable="false" />
    </div>
    <button class="bs-nav-btn bs-next-btn" id="bsNextBtn" aria-label="Next Image">&#10095;</button>
  </div>
</div>

<script>
  /* ===== Desktop-only: disable drag; use buttons. Mobile/tablet: native swipe. ===== */
  const row = document.getElementById('bsGalleryRow');
  const prevRowBtn = document.querySelector('.bs-row-prev');
  const nextRowBtn = document.querySelector('.bs-row-next');

  function cardWidth() {
    const first = row.querySelector('img');
    if (!first) return 300;
    const styles = getComputedStyle(row);
    const gap = parseFloat(styles.gap || 20);
    return first.getBoundingClientRect().width + gap;
  }

  // Buttons work on all devices
  prevRowBtn.addEventListener('click', () => row.scrollBy({ left: -cardWidth(), behavior: 'smooth' }));
  nextRowBtn.addEventListener('click', () => row.scrollBy({ left:  cardWidth(), behavior: 'smooth' }));

  // IMPORTANT: No pointer drag handlers on desktop (so no grab). We rely on native touch only on coarse pointers.
  const isCoarse = window.matchMedia('(pointer: coarse)').matches;

  if (!isCoarse) {
    // Desktop: ensure default cursor (no grabbing) and prevent accidental horizontal wheel hijack
    row.style.cursor = 'default';
  }
  // Mobile/tablet: no JS needed; native horizontal swipe works due to overflow-x:auto.
  // Vertical page scroll remains smooth because we do not block default touch events.

  /* ===== Lightbox (unchanged) ===== */
  const galleryImages = Array.from(document.querySelectorAll('.bs-gallery-row img'));
  const lightbox = document.getElementById('bsLightbox');
  const lightboxImg = document.getElementById('bsLightboxImg');
  const closeLightbox = document.getElementById('bsCloseLightbox');
  const prevBtn = document.getElementById('bsPrevBtn');
  const nextBtn = document.getElementById('bsNextBtn');
  let currentIndex = 0;

  function openLightbox(idx) {
    currentIndex = idx;
    lightboxImg.src = galleryImages[currentIndex].src;
    lightboxImg.alt = galleryImages[currentIndex].alt;
    lightbox.classList.add('bs-show');
    document.body.style.overflow = 'hidden';
    requestAnimationFrame(() => {
      lightboxImg.style.transform = 'scale(0.9)';
      lightboxImg.style.opacity = '0';
      setTimeout(() => {
        lightboxImg.style.transform = 'scale(1)';
        lightboxImg.style.opacity = '1';
      }, 50);
    });
  }

  function closeLB() {
    lightboxImg.style.transform = 'scale(0.9)';
    lightboxImg.style.opacity = '0';
    setTimeout(() => {
      lightbox.classList.remove('bs-show');
      document.body.style.overflow = '';
    }, 200);
  }

  function showPrev() {
    currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
    updateImage(true);
  }

  function showNext() {
    currentIndex = (currentIndex + 1) % galleryImages.length;
    updateImage(true);
  }

  function updateImage(animate) {
    if (animate) {
      lightboxImg.style.transition = 'opacity .3s ease, transform .3s ease';
      lightboxImg.style.opacity = '0';
      lightboxImg.style.transform = 'scale(.95)';
      setTimeout(() => {
        lightboxImg.src = galleryImages[currentIndex].src;
        lightboxImg.alt = galleryImages[currentIndex].alt;
        lightboxImg.style.opacity = '1';
        lightboxImg.style.transform = 'scale(1)';
      }, 150);
    } else {
      lightboxImg.src = galleryImages[currentIndex].src;
      lightboxImg.alt = galleryImages[currentIndex].alt;
    }
  }

  galleryImages.forEach((img, i) => {
    img.addEventListener('click', () => openLightbox(i));
  });

  prevBtn.addEventListener('click', e => { e.stopPropagation(); showPrev(); });
  nextBtn.addEventListener('click', e => { e.stopPropagation(); showNext(); });
  closeLightbox.addEventListener('click', e => { e.stopPropagation(); closeLB(); });
  lightbox.addEventListener('click', e => { if (e.target === lightbox) closeLB(); });
  document.addEventListener('keydown', e => {
    if (!lightbox.classList.contains('bs-show')) return;
    if (e.key === 'ArrowLeft') showPrev();
    if (e.key === 'ArrowRight') showNext();
    if (e.key === 'Escape') closeLB();
  });
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Customer Reviews Carousel ‚Äì Press & Hold Drag</title>
  <style>
    body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;line-height:1.6;background:#f8fafc;overflow-x:hidden;}

    .review{
      position:relative;width:100vw;left:50%;margin-left:-50vw;
      padding:clamp(4rem,10vh,6rem) 0;
      background:
        linear-gradient(to bottom,rgba(0,0,0,.30),rgba(0,0,0,.60) 60%,rgba(0,0,0,.70)),
        url('https://bajabelowsurface.com/wp-content/uploads/2025/07/Sea-lion.jpg') center/cover no-repeat;
      isolation:isolate;min-height:100vh;display:flex;flex-direction:column;justify-content:center;
    }
    .review__heading{ text-align:center;font-size:clamp(2rem,4vw,3rem);font-weight:600;color:#f6e7b0;margin-bottom:clamp(2rem,4vh,3rem); }

    /* Keep vertical scrolling as the default. Only JS will enable horizontal drag during press/hold */
    .review__viewport,
    .review__carousel{
      touch-action: pan-y pinch-zoom;
      overscroll-behavior-y: contain;
    }

    .review__viewport{ overflow:hidden; padding:15px 0 15px 2rem; width:100%; }
    .review__carousel{ display:flex; gap:clamp(2rem,4vw,3rem); transition:transform .6s cubic-bezier(.25,.8,.25,1); will-change:transform; cursor:grab; user-select:none; }
    .review__carousel.dragging{ cursor:grabbing; pointer-events:none; }

    @keyframes reviewFloat{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-15px)} }
    .review-card{
      position:relative; z-index:1; flex:0 0 100%; max-width:720px;
      background:rgba(15,27,33,.25); padding:clamp(2rem,3vw,3rem);
      border:1px solid rgba(255,255,255,.08); border-radius:32px;
      backdrop-filter:blur(12px) saturate(1.4); -webkit-backdrop-filter:blur(12px) saturate(1.4);
      box-shadow:0 8px 28px -10px rgba(0,0,0,.55); color:#e4ecef; display:flex; flex-direction:column; gap:1rem;
      animation:reviewFloat var(--float-time,12s) ease-in-out infinite; user-select:none; pointer-events:auto;
    }
    .review-card:nth-child(even){ animation-delay: calc(var(--float-time,12s)/2); }
    .review-card:hover, .review-card:focus-within{ animation-play-state:paused; z-index:2; transform:scale(1.02); transition:transform .3s ease; }

    .review-card p{ margin:0; font-size:clamp(1rem,.35vw + .9rem,1.1rem); line-height:1.6; font-weight:300; }
    .review-card .author{ margin-top:auto; font-weight:700; color:#f6e7b0; text-align:right; font-size:clamp(1rem,.35vw + .9rem,1.1rem); }

    .review__nav-container{ display:flex; justify-content:center; gap:clamp(2rem,4vw,3rem); margin-top:clamp(2rem,4vh,3rem); }
    .review__nav{
      background:#21262d; color:#f6e7b0; border:2px solid #f6e7b0; width:56px; height:56px; border-radius:50%;
      font-size:1.5rem; line-height:1; cursor:pointer; transition:all .3s ease; display:flex; align-items:center; justify-content:center; outline:none;
    }
    .review__nav:hover:not(:disabled){ background:rgba(246,231,176,.1); color:#fff; transform:scale(1.1); }
    .review__nav:active,.review__nav:focus{ background:#f6e7b0; color:#21262d; }
    .review__nav:disabled{ opacity:.4; cursor:default; }

    .review__pagination{ display:flex; justify-content:center; gap:.5rem; margin-top:1rem; }
    .review__dot{ width:12px; height:12px; border-radius:50%; background:rgba(255,255,255,.3); cursor:pointer; transition:all .3s ease; border:0; }
    .review__dot.active{ background:#f6e7b0; transform:scale(1.2); }
    .review__dot:hover{ background:rgba(255,255,255,.6); }

    @media (max-width:980px){ .review-card{ max-width:90%; flex:0 0 85%; } }
    @media (max-width:640px){
      .review-card{ flex:0 0 80%; }
      .review__viewport{ padding:15px 0 15px 1rem; }
    }
  </style>
</head>
<body>

<section class="review" id="Review" aria-label="Customer Reviews">
  <h2 class="review__heading">What Our Guests Say</h2>

  <div class="review__viewport" id="reviewViewport">
    <div class="review__carousel" id="reviewCarousel">
      <div class="review-card">
        <p>"An absolutely incredible experience! Swimming with the sea lions at Los Islotes was magical - they're so playful and curious. Daniel, our guide, was incredibly knowledgeable about marine life, and Alex, our captain, made us feel completely safe throughout the journey. The water was crystal clear, and we even spotted some dolphins on our way back. This is definitely a once-in-a-lifetime adventure that I'll treasure forever!"</p>
        <div class="author">‚Äî Jonathan M.</div>
      </div>
      <div class="review-card">
        <p>"My boyfriend and I chose the private scuba diving experience, and it exceeded all our expectations! The crew went above and beyond to create a personalized adventure just for us. After two amazing dives exploring vibrant coral reefs, they surprised us with a secluded beach picnic featuring the most delicious fresh ceviche. The attention to detail and genuine care from the entire team made this our most memorable vacation moment."</p>
        <div class="author">‚Äî Laura S.</div>
      </div>
      <div class="review-card">
        <p>"The ocean safari was pure magic! In just one day, we encountered an incredible variety of marine life that felt like a nature documentary come to life. We swam with a massive school of mobula rays - hundreds of them dancing around us! Then we had close encounters with three Bryde's whales, followed by an hour-long swim with two giant manta rays. The day ended with a pod of dolphins accompanying our boat. Absolutely unforgettable!"</p>
        <div class="author">‚Äî Samantha R.</div>
      </div>
      <div class="review-card">
        <p>"¬°Experiencia incre√≠ble! El tour de snorkel con tibur√≥n ballena y leones marinos super√≥ todas nuestras expectativas. Ver de cerca a estos gentiles gigantes del oc√©ano fue emotivo y transformador. La comida en Playa Balandra fue espectacular, y todo el equipo demostr√≥ un profundo respeto por la vida marina. Una aventura que recomiendo al 100% - regresaremos sin duda."</p>
        <div class="author">‚Äî C√©sar M.</div>
      </div>
      <div class="review-card">
        <p>"What makes this experience truly special isn't just the incredible marine encounters - it's the exceptional team behind it all. Daniel's passion for ocean conservation is infectious, Alex's seamanship skills are outstanding, and the boat Mangata is perfectly equipped for adventure. From the moment we set sail to our return, every detail was carefully planned. This team doesn't just offer tours; they create life-changing experiences!"</p>
        <div class="author">‚Äî Jim T.</div>
      </div>
    </div>
  </div>

  <div class="review__nav-container">
    <button class="review__nav" id="prevReview" aria-label="Previous review" disabled>‚Äπ</button>
    <div class="review__pagination" id="reviewPagination"></div>
    <button class="review__nav" id="nextReview" aria-label="Next review">‚Ä∫</button>
  </div>
</section>

<script>
(function(){
  const carousel   = document.getElementById('reviewCarousel');
  const viewport   = document.getElementById('reviewViewport');
  const prevBtn    = document.getElementById('prevReview');
  const nextBtn    = document.getElementById('nextReview');
  const pagination = document.getElementById('reviewPagination');
  const slides     = Array.from(carousel.children);
  const count      = slides.length;

  let idx=0, slideW=0, gap=0;
  let startX=0, startY=0, isPointerDown=false, isDragging=false, hasMoved=false, isHorizontal=false;
  const DRAG_THRESHOLD = 24;      // must move this far before we consider a drag
  const ANGLE_GUARD    = 1.35;    // horizontal must dominate vertical by 35%

  function createDots(){
    pagination.innerHTML='';
    for(let i=0;i<count;i++){
      const b=document.createElement('button');
      b.className='review__dot';
      b.setAttribute('aria-label',`Go to review ${i+1}`);
      b.onclick=()=>goTo(i);
      pagination.appendChild(b);
    }
  }
  function recalc(){
    const cs=getComputedStyle(carousel);
    gap = parseFloat(cs.gap) || 0;
    slideW = slides[0].getBoundingClientRect().width + gap;
  }
  function updateUI(){
    prevBtn.disabled = idx===0;
    nextBtn.disabled = idx===count-1;
    pagination.querySelectorAll('.review__dot').forEach((d,k)=>d.classList.toggle('active',k===idx));
  }
  function goTo(i, smooth=true){
    idx = Math.max(0, Math.min(i, count-1));
    carousel.style.transition = smooth ? 'transform .6s cubic-bezier(.25,.8,.25,1)' : 'none';
    carousel.style.transform  = `translateX(${-idx*slideW}px)`;
    updateUI();
  }

  function pointerDown(x,y){
    isPointerDown = true;
    isDragging=false; hasMoved=false; isHorizontal=false;
    startX=x; startY=y;
    carousel.style.transition='none';
  }
  function pointerMove(x,y,evt){
    if(!isPointerDown) return;                 // ONLY when pressed/held
    const dx=x-startX, dy=y-startY;

    if(!hasMoved && (Math.abs(dx)>DRAG_THRESHOLD || Math.abs(dy)>DRAG_THRESHOLD)){
      hasMoved = true;
      isHorizontal = Math.abs(dx) > Math.abs(dy)*ANGLE_GUARD;
    }
    if(hasMoved && isHorizontal){
      if(evt && evt.cancelable) evt.preventDefault();  // block page scroll only during drag
      if(!isDragging){ isDragging=true; carousel.classList.add('dragging'); }
      let newX = -idx*slideW + dx;
      const maxX=0, minX=-(count-1)*slideW;
      if(newX>maxX) newX=maxX+(newX-maxX)*0.3;
      else if(newX<minX) newX=minX+(newX-minX)*0.3;
      carousel.style.transform = `translateX(${newX}px)`;
    }
  }
  function pointerUp(x){
    if(!isDragging){ isPointerDown=false; return; }
    const dx = (x ?? startX) - startX;
    const threshold = slideW * 0.25;
    let target = idx;
    if(Math.abs(dx)>threshold) target = dx>0 ? idx-1 : idx+1;

    isPointerDown=false; isDragging=false; hasMoved=false; isHorizontal=false;
    carousel.classList.remove('dragging');
    goTo(target);
  }

  // Mouse (require button held)
  viewport.addEventListener('mousedown', e=>pointerDown(e.clientX,e.clientY));
  document.addEventListener('mousemove', e=>{
    if(e.buttons!==1) return;                  // must be pressed
    pointerMove(e.clientX,e.clientY,e);
  }, {passive:false});
  document.addEventListener('mouseup',   e=>pointerUp(e.clientX));

  // Touch
  viewport.addEventListener('touchstart', e=>pointerDown(e.touches[0].clientX,e.touches[0].clientY), {passive:true});
  viewport.addEventListener('touchmove',  e=>pointerMove(e.touches[0].clientX,e.touches[0].clientY,e), {passive:false});
  viewport.addEventListener('touchend',   e=>pointerUp(e.changedTouches?.[0]?.clientX), {passive:true});

  // Buttons & keys
  prevBtn.onclick=()=>goTo(idx-1);
  nextBtn.onclick=()=>goTo(idx+1);
  document.addEventListener('keydown', e=>{
    if(!e.target.closest('.review')) return;
    if(e.key==='ArrowLeft'){ e.preventDefault(); goTo(idx-1); }
    if(e.key==='ArrowRight'){ e.preventDefault(); goTo(idx+1); }
  });

  // Auto-advance (pause on hover)
  let auto=setInterval(()=>goTo(idx<count-1?idx+1:0),8000);
  viewport.addEventListener('mouseenter', ()=>clearInterval(auto));
  viewport.addEventListener('mouseleave', ()=>auto=setInterval(()=>goTo(idx<count-1?idx+1:0),8000));

  // Init
  window.addEventListener('resize', ()=>{ recalc(); goTo(idx,false); });
  createDots(); recalc(); goTo(0,false);
})();
</script>

</body>
</html><section class="contact" id="Contact" aria-label="Contact Us">
  <div class="contact__wrap">
    <div class="contact__panel">

      <!-- Title -->
      <h2 class="contact__heading">Get in Touch</h2>

      <!-- Icons -->
      <div class="mini-icons">
        <div class="mini-pair">
          <a class="mini-icon" href="https://instagram.com/bajabelowsurface" aria-label="Instagram" target="_blank" rel="noopener">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
              <rect x="3" y="3" width="18" height="18" rx="5" ry="5"></rect>
              <circle cx="12" cy="12" r="4"></circle>
              <circle cx="17.5" cy="6.5" r="1"></circle>
            </svg>
          </a>
          <span class="contact__icon-text">@bajabelowsurface</span>
        </div>

        <div class="mini-pair">
          <a class="mini-icon" href="mailto:dani@bajabelowsurface.com" aria-label="Email">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
              <rect x="3" y="5" width="18" height="14" rx="2" ry="2"></rect>
              <path d="M3 7l9 6 9-6"></path>
            </svg>
          </a>
          <span class="contact__icon-text">dani@bajabelowsurface.com</span>
        </div>
      </div>

      <!-- Contact Form -->
      <form class="contact__form" action="<?php echo esc_url( admin_url('admin-post.php') ); ?>" method="post">
        <input type="hidden" name="action" value="cf7_submit">
        <input type="text" name="your-name" placeholder="Your Name" class="contact__input" required>
        <input type="email" name="your-email" placeholder="Your Email" class="contact__input" required>
        <textarea name="your-message" placeholder="Your Message" class="contact__textarea" required></textarea>
        <button type="submit" class="contact__btn">SEND MESSAGE</button>
      </form>

    </div>
  </div>
</section>

<style>
  .mini-icons {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-bottom: 1.2rem;
  }
  .mini-pair {
    display: flex;
    align-items: center;
    gap: 8px;
    white-space: nowrap;
  }
  .mini-icon {
    --size: 26px;
    --pad: 8px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: calc(var(--size) + var(--pad) * 2);
    height: calc(var(--size) + var(--pad) * 2);
    color: #f5e6af;
    background: transparent;
    border-radius: 999px;
    text-decoration: none;
    transition: background 0.2s ease, transform 0.05s ease;
    flex-shrink: 0;
  }
  .mini-icon:hover {
    background: #f5e6af;
    color: #21262d;
  }
  .mini-icon:active {
    transform: translateY(1px);
  }
  .mini-icon:focus-visible {
    outline: 2px solid #f5e6af;
    outline-offset: 2px;
  }
  .mini-icon svg {
    width: var(--size);
    height: var(--size);
    display: block;
  }
  .contact__icon-text {
    color: #f5e6af;
    font-weight: 600;
    font-size: 1rem;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: center;
  }
  @media (max-width: 640px) {
    .mini-icons {
      align-items: center;
    }
    .contact__icon-text {
      font-size: 0.95rem;
      max-width: 250px;
    }
  }
  .contact__form input[type="text"],
  .contact__form input[type="email"],
  .contact__form textarea {
    width: 100%;
    padding: 12px;
    border-radius: 6px;
    border: none;
    background: transparent;
    border: 2px solid #f5e6af;
    color: #f5e6af;
    font-size: 1rem;
    font-weight: 500;
    margin-bottom: 12px;
  }
  .contact__form input::placeholder,
  .contact__form textarea::placeholder {
    color: #f5e6af;
    opacity: 0.7;
  }
  .contact__form textarea {
    resize: vertical;
    min-height: 100px;
  }
  .contact__btn {
    background: #f5e6af;
    color: #21262d;
    border: none;
    padding: 12px 20px;
    font-weight: 700;
    cursor: pointer;
    border-radius: 6px;
    transition: background 0.2s ease, color 0.2s ease;
  }
  .contact__btn:hover {
    background: #21262d;
    color: #f5e6af;
  }
</style>
<!-- WhatsApp Floating Button -->
<a
  href="https://wa.me/526242104724"
  class="whatsapp-button"
  target="_blank"
  aria-label="Chat on WhatsApp"
>
  <img
    src="https://www.svgrepo.com/show/303280/whatsapp-glyph-black-logo.svg"
    alt="WhatsApp"
    style="width:2rem;height:2rem;display:block;"
  />
</a>
<script>
document.addEventListener('scroll',function(){
  document.body.classList.toggle('scrolled', window.scrollY>10);
},{passive:true});
</script>
<!-- ===== Hamburger Menu (RESPONSIVE: titles perfectly centered; socials pinned bottom. Desktop keeps extra top padding.) ===== -->
<style>
  :root{
    --accent:#f6e7b0;     /* yellow tone */
    --ink:#21262d;        /* blue/ink tone */
    --overlay:rgba(10,14,18,.88);
    --glass:blur(14px) saturate(1.2);
    --z:99999;
  }

  /* Hamburger: yellow lines only, no hover bg */
  .ham{
    position:fixed; top:clamp(10px,2vh,18px); left:clamp(10px,2vw,18px);
    width:48px; height:48px; border:0; background:transparent; padding:0; cursor:pointer;
    display:grid; place-items:center; z-index:var(--z); border-radius:12px;
  }
  .ham:hover, .ham:focus, .ham:focus-visible{ background:transparent; box-shadow:none; outline:none; }
  .ham__icon{ width:24px; height:18px; position:relative; }
  .ham__bar{
    position:absolute; left:0; right:0; height:2px; background:var(--accent);
    border-radius:2px; transform-origin:50% 50%;
    transition:transform .24s ease, opacity .2s ease, top .24s ease, bottom .24s ease;
  }
  .ham__bar--1{ top:0; }
  .ham__bar--2{ top:8px; }
  .ham__bar--3{ bottom:0; }
  .ham[aria-expanded="true"] .ham__bar--1{ top:8px; transform:rotate(45deg); }
  .ham[aria-expanded="true"] .ham__bar--2{ opacity:0; }
  .ham[aria-expanded="true"] .ham__bar--3{ bottom:auto; top:8px; transform:rotate(-45deg); }

  /* Overlay */
  .menu{
    position:fixed; inset:0; display:none; z-index:calc(var(--z) - 1);
    background:var(--overlay); -webkit-backdrop-filter:var(--glass); backdrop-filter:var(--glass);
  }
  .menu.is-open{ display:block; animation:fadeIn .22s ease forwards; }
  @keyframes fadeIn{ from{opacity:0} to{opacity:1} }

  /* Container:
     - Desktop: column with titles near upper middle (extra top padding)
     - Mobile: grid: titles perfectly centered; socials pinned to bottom
  */
  .menu__container{
    height:100%; width:100%;
    display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
    padding: 0 20px;
  }

  /* Titles wrapper (lets us center on mobile without affecting desktop) */
  .menu__center{
    width:100%;
    display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  }

  /* Menu list */
  .menu__list{
    list-style:none; margin:0; padding:6rem 0 2rem;  /* extra top padding on desktop */
    display:grid; gap:10px; text-align:center; place-items:center;
  }

  /* Links with staggered fade-in */
  .menu__link{
    display:inline-block; padding:.6rem 1.2rem;
    border-radius:14px; text-decoration:none; font-weight:800; letter-spacing:.4px;
    font-size:clamp(1.6rem, 1.4vw + 1rem, 2.2rem);   /* slightly smaller on desktop */
    color:var(--accent); background:transparent;
    transition:transform .2s ease, color .2s ease, background .2s ease, box-shadow .2s ease;
    opacity:0; transform:translateY(10px);
    animation:rise .4s ease forwards; animation-delay:var(--delay, 0s);
  }
  @keyframes rise{ to{ opacity:1; transform:none; } }

  /* Active (only one set in JS) */
  .menu__link.is-active,
  .menu__link[aria-current="page"]{ background:var(--accent); color:var(--ink); }

  /* Hover */
  .menu__link:hover, .menu__link:focus{
    background:var(--accent); color:var(--ink);
    transform:translateY(-2px); box-shadow:0 16px 34px -14px rgba(0,0,0,.45); outline:0;
  }

  /* Socials pinned bottom */
  .mini-icons{
    width:100%; display:flex; flex-direction:column; align-items:center; gap:10px;
    padding: 16px 0 28px;
  }
  .mini-pair{ display:flex; align-items:center; gap:10px; white-space:nowrap; }
  .mini-icon{
    --size:26px; --pad:8px;
    display:inline-flex; align-items:center; justify-content:center;
    width:calc(var(--size) + var(--pad)*2); height:calc(var(--size) + var(--pad)*2);
    color:var(--accent); background:transparent; border-radius:999px; text-decoration:none;
    transition:background .2s ease, transform .05s ease; flex-shrink:0;
  }
  .mini-icon:hover{ background:var(--accent); color:var(--ink); }
  .mini-icon svg{ width:var(--size); height:var(--size); display:block; }
  .contact__icon-text{ color:var(--accent); font-weight:600; font-size:1rem; }

  /* ===== MOBILE/TABLET: center titles dead-middle; socials fixed at bottom ===== */
  @media (max-width: 768px){
    .menu__container{
      display:grid;
      grid-template-rows: 1fr auto;     /* row1 = center area, row2 = socials */
      align-items:stretch; justify-items:center;
      padding: 0 20px;
    }
    .menu__center{
      grid-row:1;
      display:flex; align-items:center; justify-content:center;  /* TRUE vertical centering */
      width:100%;
    }
    .menu__list{
      padding: 0;                        /* remove desktop top padding on mobile */
      gap: 12px;
    }
  }
</style>

<!-- Button -->
<button class="ham" id="ham" aria-label="Open menu" aria-controls="menu" aria-expanded="false">
  <span class="ham__icon" aria-hidden="true">
    <span class="ham__bar ham__bar--1"></span>
    <span class="ham__bar ham__bar--2"></span>
    <span class="ham__bar ham__bar--3"></span>
  </span>
</button>

<!-- Fullscreen Menu -->
<nav class="menu" id="menu" aria-hidden="true">
  <div class="menu__container">
    <!-- CENTERED TITLES AREA -->
    <div class="menu__center">
      <ul class="menu__list" role="menu" aria-label="Main menu">
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/" style="--delay:.00s">Home</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1215" style="--delay:.08s">Day Trips</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1384" style="--delay:.16s">Expeditions</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1386" style="--delay:.24s">Charter</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1397" style="--delay:.32s">About Us</a></li>
      </ul>
    </div>

    <!-- SOCIALS AT BOTTOM -->
    <div class="mini-icons">
      <div class="mini-pair">
        <a class="mini-icon" href="https://instagram.com/bajabelowsurface" aria-label="Instagram" target="_blank" rel="noopener">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
            <rect x="3" y="3" width="18" height="18" rx="5" ry="5"></rect>
            <circle cx="12" cy="12" r="4"></circle>
            <circle cx="17.5" cy="6.5" r="1"></circle>
          </svg>
        </a>
        <span class="contact__icon-text">@bajabelowsurface</span>
      </div>
      <div class="mini-pair">
        <a class="mini-icon" href="mailto:dani@bajabelowsurface.com" aria-label="Email">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
            <rect x="3" y="5" width="18" height="14" rx="2" ry="2"></rect>
            <path d="M3 7l9 6 9-6"></path>
          </svg>
        </a>
        <span class="contact__icon-text">dani@bajabelowsurface.com</span>
      </div>
    </div>
  </div>
</nav>

<script>
(function(){
  const btn = document.getElementById('ham');
  const menu = document.getElementById('menu');
  const links = menu.querySelectorAll('.menu__link');
  let lastFocus = null;

  // Ensure ONLY one active link
  const norm = (u)=>{ try{ const x=new URL(u, location.origin); return (x.origin+x.pathname+x.search).replace(/\/+$/,''); } catch(e){ return u; } };
  const here = norm(location.href);
  links.forEach(l => { l.classList.remove('is-active'); l.removeAttribute('aria-current'); });
  links.forEach(a => { if (norm(a.href) === here) { a.classList.add('is-active'); a.setAttribute('aria-current','page'); } });

  const lock = (on)=>{ document.documentElement.style.overflow = on ? 'hidden' : ''; };

  function openMenu(){
    lastFocus = document.activeElement;
    btn.setAttribute('aria-expanded','true');
    menu.classList.add('is-open');
    menu.removeAttribute('aria-hidden');
    lock(true);
    document.addEventListener('click', onAnyClick);
    document.addEventListener('keydown', onKey);
  }
  function closeMenu(){
    btn.setAttribute('aria-expanded','false');
    menu.classList.remove('is-open');
    menu.setAttribute('aria-hidden','true');
    lock(false);
    document.removeEventListener('click', onAnyClick);
    document.removeEventListener('keydown', onKey);
    if(lastFocus) lastFocus.focus();
  }
  function toggle(){ btn.getAttribute('aria-expanded')==='true' ? closeMenu() : openMenu(); }

  function onAnyClick(e){
    if (e.target===btn || btn.contains(e.target)) return;
    if (!menu.contains(e.target)) closeMenu();
  }
  function onKey(e){ if(e.key==='Escape') closeMenu(); }

  btn.addEventListener('click', e=>{ e.stopPropagation(); toggle(); });
  links.forEach(a => a.addEventListener('click', closeMenu));
})();
</script>
