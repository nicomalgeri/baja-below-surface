<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Below Surface - Marine Adventures</title>
  <link rel="stylesheet" href="assets/css/main.css?v=1">
  <!-- Preload critical resources -->
  <link rel="preconnect" href="https://bajabelowsurface.com">
  <link rel="preload" href="https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video.mov" as="video" type="video/mp4">
</head>

<body>
  <div class="bs-container">
    <div class="bs-hero-wrapper">
      <!-- Video Background -->
      <video 
        id="bsMainVideo" 
        class="bs-hero-video" 
        autoplay 
        muted 
        loop 
        playsinline
        preload="metadata"
        aria-hidden="true"
      >
        <source src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video.mov" type="video/mp4">
        <div class="bs-sr-only">Your browser does not support the video tag.</div>
      </video>
      
      <div class="bs-hero-overlay" aria-hidden="true"></div>

      <!-- Hero Section -->
      <header class="bs-hero" id="bsTop" role="banner">
        <div class="bs-hero__content">
          <h1 class="bs-hero__text bs-hero__text--1">
            Unlock The Underwater Mysteries
          </h1>
          <h1 class="bs-hero__text bs-hero__text--2" aria-hidden="true">
            Join Us for an Experience Where the Hidden Depths Come to Life
          </h1>
          
          <a 
            href="#bsServices" 
            class="bs-hero__scroll" 
            aria-label="Scroll to Services section"
            role="button"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <polyline points="6 9 12 15 18 9" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="bs-sr-only">Scroll to Services</span>
          </a>
        </div>
      </header>

      <!-- Services Section -->
      <section class="bs-services" id="bsServices" aria-labelledby="bsServicesHeading">
        <h2 id="bsServicesHeading" class="bs-sr-only">Our Marine Adventure Services</h2>
        
        <div class="bs-services__grid" role="list">
          <!-- Day Trips -->
          <article 
            class="bs-service-card bs-loading" 
            style="--delay: 0s; --img: url('https://bajabelowsurface.com/wp-content/uploads/2025/07/WhatsApp-Image-2025-07-08-at-05.59.56-scaled.jpeg')"
            role="listitem"
            data-url="https://bajabelowsurface.com/?page_id=1215"
          >
            <div class="bs-service-card__media" aria-hidden="true"></div>
            <div class="bs-service-card__content">
              <h3 class="bs-service-card__title">Day Trips</h3>
              <div class="bs-service-card__details">
                <p class="bs-service-card__text">
                  Single-day marine adventures: reefs, wildlife encounters &amp; expert guides.
                </p>
                <button 
                  class="bs-service-card__cta" 
                  aria-label="Learn more about Day Trips"
                  data-service="day-trips"
                >
                  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M12 2l-1.41 1.41L16.17 9H4v2h12.17l-5.58 5.59L12 18l8-8z"/>
                  </svg>
                </button>
              </div>
            </div>
          </article>

          <!-- Expeditions -->
          <article 
            class="bs-service-card bs-loading" 
            style="--delay: .45s; --img: url('https://bajabelowsurface.com/wp-content/uploads/2025/07/WhatsApp-Image-2025-07-08-at-06.00.23-scaled.jpeg')"
            role="listitem"
            data-url="https://bajabelowsurface.com/?page_id=1384"
          >
            <div class="bs-service-card__media" aria-hidden="true"></div>
            <div class="bs-service-card__content">
              <h3 class="bs-service-card__title">Expeditions</h3>
              <div class="bs-service-card__details">
                <p class="bs-service-card__text">
                  Multi-day remote exploration, research support &amp; immersive learning.
                </p>
                <button 
                  class="bs-service-card__cta" 
                  aria-label="Learn more about Expeditions"
                  data-service="expeditions"
                >
                  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M12 2l-1.41 1.41L16.17 9H4v2h12.17l-5.58 5.59L12 18l8-8z"/>
                  </svg>
                </button>
              </div>
            </div>
          </article>

          <!-- Charter -->
          <article 
            class="bs-service-card bs-loading" 
            style="--delay: .9s; --img: url('https://bajabelowsurface.com/wp-content/uploads/2025/07/WhatsApp-Image-2025-07-08-at-06.00.36.jpeg')"
            role="listitem"
            data-url="https://bajabelowsurface.com/?page_id=1386"
          >
            <div class="bs-service-card__media" aria-hidden="true"></div>
            <div class="bs-service-card__content">
              <h3 class="bs-service-card__title">Charter</h3>
              <div class="bs-service-card__details">
                <p class="bs-service-card__text">
                  Private vessel, bespoke itinerary, full crew &amp; logistics handled.
                </p>
                <button 
                  class="bs-service-card__cta" 
                  aria-label="Learn more about Charter services"
                  data-service="charter"
                >
                  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M12 2l-1.41 1.41L16.17 9H4v2h12.17l-5.58 5.59L12 18l8-8z"/>
                  </svg>
                </button>
              </div>
            </div>
          </article>
        </div>
      </section>
    </div>
  </div>

  <script>
    /**
     * Below Surface - Enhanced JavaScript Module
     * Optimized for WordPress/Elementor compatibility
     */
    (function() {
      'use strict';
      
      // Performance and error handling utilities
      const BSUtils = {
        // Debounce function for performance
        debounce: function(func, wait) {
          let timeout;
          return function executedFunction(...args) {
            const later = () => {
              clearTimeout(timeout);
              func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
          };
        },

        // Safe DOM query with error handling
        safeQuery: function(selector, context = document) {
          try {
            return context.querySelector(selector);
          } catch (e) {
            console.warn(`BS: Invalid selector "${selector}":`, e);
            return null;
          }
        },

        // Check if element is in viewport
        isInViewport: function(element) {
          if (!element) return false;
          const rect = element.getBoundingClientRect();
          return (
            rect.top >= 0 &&
            rect.left >= 0 &&
            rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
            rect.right <= (window.innerWidth || document.documentElement.clientWidth)
          );
        },

        // Smooth scroll with fallback
        smoothScroll: function(target) {
          if (target) {
            if ('scrollBehavior' in document.documentElement.style) {
              target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
              // Fallback for older browsers
              const targetPosition = target.offsetTop;
              window.scrollTo({
                top: targetPosition,
                behavior: 'smooth'
              });
            }
          }
        }
      };

      // Video Management Module
      const VideoManager = {
        init: function() {
          this.video = BSUtils.safeQuery('#bsMainVideo');
          if (!this.video) return;

          this.setupResponsiveVideo();
          this.setupVideoErrorHandling();
          
          // Resize listener with debouncing
          window.addEventListener('resize', BSUtils.debounce(this.setupResponsiveVideo.bind(this), 250));
        },

        setupResponsiveVideo: function() {
          if (!this.video) return;

          const desktopSrc = 'https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video-1.mov';
          const mobileSrc = 'https://bajabelowsurface.com/wp-content/uploads/2025/07/Main-Video.mov';
          const isMobile = window.innerWidth < 768;
          const targetSrc = isMobile ? mobileSrc : desktopSrc;
          
          const currentSource = this.video.querySelector('source');
          if (currentSource && currentSource.getAttribute('src') === targetSrc) {
            return; // Source is already correct
          }

          this.video.pause();
          this.video.innerHTML = '';
          
          const newSource = document.createElement('source');
          newSource.src = targetSrc;
          newSource.type = 'video/mp4';
          
          this.video.appendChild(newSource);
          this.video.load();
          
          // Auto-play with error handling
          const playPromise = this.video.play();
          if (playPromise !== undefined) {
            playPromise.catch(error => {
              console.warn('BS: Video autoplay failed:', error);
              // Video autoplay was prevented, which is normal on some devices
            });
          }
        },

        setupVideoErrorHandling: function() {
          if (!this.video) return;

          this.video.addEventListener('error', (e) => {
            console.error('BS: Video error:', e);
            // Hide video overlay on error to prevent black screen
            const overlay = BSUtils.safeQuery('.bs-hero-overlay');
            if (overlay) {
              overlay.style.opacity = '0.9';
            }
          });

          this.video.addEventListener('loadeddata', () => {
            console.log('BS: Video loaded successfully');
          });
        }
      };

      // Service Cards Module
      const ServiceCards = {
        init: function() {
          this.cards = document.querySelectorAll('.bs-service-card');
          this.setupClickHandlers();
          this.setupKeyboardNavigation();
          this.setupIntersectionObserver();
        },

        setupClickHandlers: function() {
          this.cards.forEach(card => {
            const button = card.querySelector('.bs-service-card__cta');
            const url = card.dataset.url;
            
            if (button && url) {
              button.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                this.handleServiceClick(button, url);
              });

              // Also handle card click
              card.addEventListener('click', (e) => {
                if (e.target === button || button.contains(e.target)) return;
                this.handleServiceClick(button, url);
              });
            }
          });
        },

        setupKeyboardNavigation: function() {
          this.cards.forEach(card => {
            card.setAttribute('tabindex', '0');
            
            card.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                const url = card.dataset.url;
                if (url) {
                  const button = card.querySelector('.bs-service-card__cta');
                  this.handleServiceClick(button, url);
                }
              }
            });
          });
        },

        setupIntersectionObserver: function() {
          if (!('IntersectionObserver' in window)) {
            // Fallback: just add loaded class to all cards
            this.cards.forEach(card => card.classList.add('bs-loaded'));
            return;
          }

          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                entry.target.classList.add('bs-loaded');
                observer.unobserve(entry.target);
              }
            });
          }, {
            rootMargin: '50px',
            threshold: 0.1
          });

          this.cards.forEach(card => observer.observe(card));
        },

        handleServiceClick: function(button, url) {
          if (!button || !url) return;

          // Visual feedback
          this.createRippleEffect(button);
          
          // Track analytics if available
          if (typeof gtag === 'function') {
            gtag('event', 'service_click', {
              'service_type': button.dataset.service || 'unknown',
              'destination_url': url
            });
          }

          // Navigate after brief delay for visual feedback
          setTimeout(() => {
            window.location.href = url;
          }, 200);
        },

        createRippleEffect: function(button) {
          const existingRipple = button.querySelector('.bs-ripple');
          if (existingRipple) {
            existingRipple.remove();
          }

          const ripple = document.createElement('span');
          ripple.className = 'bs-ripple';
          ripple.style.cssText = `
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            background: rgba(246,231,176,.25);
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            transform: scale(0);
            opacity: 0.4;
            transition: none;
          `;

          button.appendChild(ripple);

          requestAnimationFrame(() => {
            ripple.style.transition = 'transform 0.6s ease-out, opacity 0.6s ease-out';
            ripple.style.transform = 'scale(1.8)';
            ripple.style.opacity = '0';
          });

          // Clean up ripple element
          setTimeout(() => {
            if (ripple.parentNode) {
              ripple.parentNode.removeChild(ripple);
            }
          }, 600);
        }
      };

      // Navigation Module
      const Navigation = {
        init: function() {
          this.setupScrollButton();
          this.setupSmoothScrolling();
        },

        setupScrollButton: function() {
          const scrollButton = BSUtils.safeQuery('.bs-hero__scroll');
          if (!scrollButton) return;

          scrollButton.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = scrollButton.getAttribute('href');
            const target = BSUtils.safeQuery(targetId);
            
            if (target) {
              BSUtils.smoothScroll(target);
              
              // Focus target for accessibility
              setTimeout(() => {
                target.setAttribute('tabindex', '-1');
                target.focus();
              }, 500);
            }
          });
        },

        setupSmoothScrolling: function() {
          // Handle any internal links with smooth scrolling
          const internalLinks = document.querySelectorAll('a[href^="#bs"]');
          
          internalLinks.forEach(link => {
            link.addEventListener('click', (e) => {
              e.preventDefault();
              const targetId = link.getAttribute('href');
              const target = BSUtils.safeQuery(targetId);
              
              if (target) {
                BSUtils.smoothScroll(target);
              }
            });
          });
        }
      };

      // Error Handling Module
      const ErrorHandler = {
        init: function() {
          window.addEventListener('error', this.handleError);
          window.addEventListener('unhandledrejection', this.handlePromiseRejection);
        },

        handleError: function(event) {
          console.error('BS: Runtime error:', event.error);
          // Don't break the entire page for individual component errors
        },

        handlePromiseRejection: function(event) {
          console.error('BS: Promise rejection:', event.reason);
          // Prevent unhandled promise rejections from breaking the page
          event.preventDefault();
        }
      };

      // Main Initialization
      const BelowSurface = {
        init: function() {
          try {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
              document.addEventListener('DOMContentLoaded', () => this.bootstrap());
            } else {
              this.bootstrap();
            }
          } catch (error) {
            console.error('BS: Initialization failed:', error);
          }
        },

        bootstrap: function() {
          console.log('BS: Initializing Below Surface components...');
          
          // Initialize error handling first
          ErrorHandler.init();
          
          // Initialize all modules
          VideoManager.init();
          ServiceCards.init();
          Navigation.init();
          
          // Mark as initialized
          document.body.classList.add('bs-initialized');
          
          console.log('BS: Initialization complete');
        }
      };

      // Auto-initialize
      BelowSurface.init();

      // Expose for external use if needed
      window.BelowSurface = BelowSurface;
      
    })();
  </script>
</body>
</html>
<!-- ============ ABOUT (FULL-WIDTH, FLOATING GLASS PANELS) ============ -->
<section class="about" id="About" aria-label="About Us">
  <div class="about__wrap">
    <figure class="about__media" aria-hidden="true">
      <img src="https://bajabelowsurface.com/wp-content/uploads/2025/08/Untitled-design-2.png" alt="Guide at sea">
    </figure>

    <article class="about__panel">
      <h2 class="about__heading">Get to Know Us</h2>
      <p class="about__text">
        At the heart of our mission lies a simple yet powerful goal: to inspire wonder and foster
        connection through the incredible diversity of marine life that calls the ocean home.
      </p>
      <p class="about__text">
        Every expedition, day trip, and charter blends responsible exploration with authentic local
        insight—helping guests experience hidden depths while protecting them for future generations.
      </p>
      <a class="about__btn" href="https://bajabelowsurface.com/?page_id=1397">Read&nbsp;More</a>
    </article>
  </div>
</section>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Below Surface Gallery</title>
  <link rel="stylesheet" href="assets/css/main.css?v=1">
</head>
<body>

<section class="bs-fullscreen-gallery" aria-label="Below Surface Gallery">

  <h1 class="bs-gallery-title">Gallery</h1>

  <div class="bs-gallery-column">
    <div class="bs-row-wrap">
      <!-- DESKTOP: use only buttons; MOBILE/TABLET: native swipe works -->
      <button class="bs-row-btn bs-row-prev" aria-label="Scroll previous" type="button">&#10094;</button>

      <div class="bs-gallery-row" id="bsGalleryRow">
        <!-- ONE STRIPE ONLY — NO REPEATS -->
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Scuba-Diving-1.avif" alt="Scuba Diving Adventure" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Sea-Lion-Snorkel-1.avif" alt="Sea Lion Snorkelling" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Sunset-in-Paradise-1.avif" alt="Sunset in Paradise" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Whale-Watching-1.avif" alt="Whale Watching" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Whale-Shark-Snorkel-1.avif" alt="Whale Shark Snorkel" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Sport-Fishing-1.avif" alt="Sport Fishing" />
        <img src="https://bajabelowsurface.com/wp-content/uploads/2025/07/Ocean-Safari-1.avif" alt="Ocean Safari" />
      </div>

      <button class="bs-row-btn bs-row-next" aria-label="Scroll next" type="button">&#10095;</button>
    </div>
  </div>

  <div class="bs-video-column">
    <div class="bs-video-wrapper">
      <video id="bsMainVideo" controls playsinline preload="metadata">
        <source src="https://bajabelowsurface.com/wp-content/uploads/2025/08/Main-Video-1.mov" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
  </div>

</section>

<!-- Lightbox -->
<div class="bs-lightbox" id="bsLightbox">
  <div class="bs-lightbox-content">
    <button class="bs-close-btn" id="bsCloseLightbox" aria-label="Close Gallery">&times;</button>
    <button class="bs-nav-btn bs-prev-btn" id="bsPrevBtn" aria-label="Previous Image">&#10094;</button>
    <div class="bs-lightbox-img-wrapper">
      <img src="" id="bsLightboxImg" alt="Expanded gallery image" draggable="false" />
    </div>
    <button class="bs-nav-btn bs-next-btn" id="bsNextBtn" aria-label="Next Image">&#10095;</button>
  </div>
</div>

<script>
  /* ===== Desktop-only: disable drag; use buttons. Mobile/tablet: native swipe. ===== */
  const row = document.getElementById('bsGalleryRow');
  const prevRowBtn = document.querySelector('.bs-row-prev');
  const nextRowBtn = document.querySelector('.bs-row-next');

  function cardWidth() {
    const first = row.querySelector('img');
    if (!first) return 300;
    const styles = getComputedStyle(row);
    const gap = parseFloat(styles.gap || 20);
    return first.getBoundingClientRect().width + gap;
  }

  // Buttons work on all devices
  prevRowBtn.addEventListener('click', () => row.scrollBy({ left: -cardWidth(), behavior: 'smooth' }));
  nextRowBtn.addEventListener('click', () => row.scrollBy({ left:  cardWidth(), behavior: 'smooth' }));

  // IMPORTANT: No pointer drag handlers on desktop (so no grab). We rely on native touch only on coarse pointers.
  const isCoarse = window.matchMedia('(pointer: coarse)').matches;

  if (!isCoarse) {
    // Desktop: ensure default cursor (no grabbing) and prevent accidental horizontal wheel hijack
    row.style.cursor = 'default';
  }
  // Mobile/tablet: no JS needed; native horizontal swipe works due to overflow-x:auto.
  // Vertical page scroll remains smooth because we do not block default touch events.

  /* ===== Lightbox (unchanged) ===== */
  const galleryImages = Array.from(document.querySelectorAll('.bs-gallery-row img'));
  const lightbox = document.getElementById('bsLightbox');
  const lightboxImg = document.getElementById('bsLightboxImg');
  const closeLightbox = document.getElementById('bsCloseLightbox');
  const prevBtn = document.getElementById('bsPrevBtn');
  const nextBtn = document.getElementById('bsNextBtn');
  let currentIndex = 0;

  function openLightbox(idx) {
    currentIndex = idx;
    lightboxImg.src = galleryImages[currentIndex].src;
    lightboxImg.alt = galleryImages[currentIndex].alt;
    lightbox.classList.add('bs-show');
    document.body.style.overflow = 'hidden';
    requestAnimationFrame(() => {
      lightboxImg.style.transform = 'scale(0.9)';
      lightboxImg.style.opacity = '0';
      setTimeout(() => {
        lightboxImg.style.transform = 'scale(1)';
        lightboxImg.style.opacity = '1';
      }, 50);
    });
  }

  function closeLB() {
    lightboxImg.style.transform = 'scale(0.9)';
    lightboxImg.style.opacity = '0';
    setTimeout(() => {
      lightbox.classList.remove('bs-show');
      document.body.style.overflow = '';
    }, 200);
  }

  function showPrev() {
    currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
    updateImage(true);
  }

  function showNext() {
    currentIndex = (currentIndex + 1) % galleryImages.length;
    updateImage(true);
  }

  function updateImage(animate) {
    if (animate) {
      lightboxImg.style.transition = 'opacity .3s ease, transform .3s ease';
      lightboxImg.style.opacity = '0';
      lightboxImg.style.transform = 'scale(.95)';
      setTimeout(() => {
        lightboxImg.src = galleryImages[currentIndex].src;
        lightboxImg.alt = galleryImages[currentIndex].alt;
        lightboxImg.style.opacity = '1';
        lightboxImg.style.transform = 'scale(1)';
      }, 150);
    } else {
      lightboxImg.src = galleryImages[currentIndex].src;
      lightboxImg.alt = galleryImages[currentIndex].alt;
    }
  }

  galleryImages.forEach((img, i) => {
    img.addEventListener('click', () => openLightbox(i));
  });

  prevBtn.addEventListener('click', e => { e.stopPropagation(); showPrev(); });
  nextBtn.addEventListener('click', e => { e.stopPropagation(); showNext(); });
  closeLightbox.addEventListener('click', e => { e.stopPropagation(); closeLB(); });
  lightbox.addEventListener('click', e => { if (e.target === lightbox) closeLB(); });
  document.addEventListener('keydown', e => {
    if (!lightbox.classList.contains('bs-show')) return;
    if (e.key === 'ArrowLeft') showPrev();
    if (e.key === 'ArrowRight') showNext();
    if (e.key === 'Escape') closeLB();
  });
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Customer Reviews Carousel – Press & Hold Drag</title>
  <link rel="stylesheet" href="assets/css/main.css?v=1">
</head>
<body>

<section class="review" id="Review" aria-label="Customer Reviews">
  <h2 class="review__heading">What Our Guests Say</h2>

  <div class="review__viewport" id="reviewViewport">
    <div class="review__carousel" id="reviewCarousel">
      <div class="review-card">
        <p>"An absolutely incredible experience! Swimming with the sea lions at Los Islotes was magical - they're so playful and curious. Daniel, our guide, was incredibly knowledgeable about marine life, and Alex, our captain, made us feel completely safe throughout the journey. The water was crystal clear, and we even spotted some dolphins on our way back. This is definitely a once-in-a-lifetime adventure that I'll treasure forever!"</p>
        <div class="author">— Jonathan M.</div>
      </div>
      <div class="review-card">
        <p>"My boyfriend and I chose the private scuba diving experience, and it exceeded all our expectations! The crew went above and beyond to create a personalized adventure just for us. After two amazing dives exploring vibrant coral reefs, they surprised us with a secluded beach picnic featuring the most delicious fresh ceviche. The attention to detail and genuine care from the entire team made this our most memorable vacation moment."</p>
        <div class="author">— Laura S.</div>
      </div>
      <div class="review-card">
        <p>"The ocean safari was pure magic! In just one day, we encountered an incredible variety of marine life that felt like a nature documentary come to life. We swam with a massive school of mobula rays - hundreds of them dancing around us! Then we had close encounters with three Bryde's whales, followed by an hour-long swim with two giant manta rays. The day ended with a pod of dolphins accompanying our boat. Absolutely unforgettable!"</p>
        <div class="author">— Samantha R.</div>
      </div>
      <div class="review-card">
        <p>"¡Experiencia increíble! El tour de snorkel con tiburón ballena y leones marinos superó todas nuestras expectativas. Ver de cerca a estos gentiles gigantes del océano fue emotivo y transformador. La comida en Playa Balandra fue espectacular, y todo el equipo demostró un profundo respeto por la vida marina. Una aventura que recomiendo al 100% - regresaremos sin duda."</p>
        <div class="author">— César M.</div>
      </div>
      <div class="review-card">
        <p>"What makes this experience truly special isn't just the incredible marine encounters - it's the exceptional team behind it all. Daniel's passion for ocean conservation is infectious, Alex's seamanship skills are outstanding, and the boat Mangata is perfectly equipped for adventure. From the moment we set sail to our return, every detail was carefully planned. This team doesn't just offer tours; they create life-changing experiences!"</p>
        <div class="author">— Jim T.</div>
      </div>
    </div>
  </div>

  <div class="review__nav-container">
    <button class="review__nav" id="prevReview" aria-label="Previous review" disabled>‹</button>
    <div class="review__pagination" id="reviewPagination"></div>
    <button class="review__nav" id="nextReview" aria-label="Next review">›</button>
  </div>
</section>

<script>
(function(){
  const carousel   = document.getElementById('reviewCarousel');
  const viewport   = document.getElementById('reviewViewport');
  const prevBtn    = document.getElementById('prevReview');
  const nextBtn    = document.getElementById('nextReview');
  const pagination = document.getElementById('reviewPagination');
  const slides     = Array.from(carousel.children);
  const count      = slides.length;

  let idx=0, slideW=0, gap=0;
  let startX=0, startY=0, isPointerDown=false, isDragging=false, hasMoved=false, isHorizontal=false;
  const DRAG_THRESHOLD = 24;      // must move this far before we consider a drag
  const ANGLE_GUARD    = 1.35;    // horizontal must dominate vertical by 35%

  function createDots(){
    pagination.innerHTML='';
    for(let i=0;i<count;i++){
      const b=document.createElement('button');
      b.className='review__dot';
      b.setAttribute('aria-label',`Go to review ${i+1}`);
      b.onclick=()=>goTo(i);
      pagination.appendChild(b);
    }
  }
  function recalc(){
    const cs=getComputedStyle(carousel);
    gap = parseFloat(cs.gap) || 0;
    slideW = slides[0].getBoundingClientRect().width + gap;
  }
  function updateUI(){
    prevBtn.disabled = idx===0;
    nextBtn.disabled = idx===count-1;
    pagination.querySelectorAll('.review__dot').forEach((d,k)=>d.classList.toggle('active',k===idx));
  }
  function goTo(i, smooth=true){
    idx = Math.max(0, Math.min(i, count-1));
    carousel.style.transition = smooth ? 'transform .6s cubic-bezier(.25,.8,.25,1)' : 'none';
    carousel.style.transform  = `translateX(${-idx*slideW}px)`;
    updateUI();
  }

  function pointerDown(x,y){
    isPointerDown = true;
    isDragging=false; hasMoved=false; isHorizontal=false;
    startX=x; startY=y;
    carousel.style.transition='none';
  }
  function pointerMove(x,y,evt){
    if(!isPointerDown) return;                 // ONLY when pressed/held
    const dx=x-startX, dy=y-startY;

    if(!hasMoved && (Math.abs(dx)>DRAG_THRESHOLD || Math.abs(dy)>DRAG_THRESHOLD)){
      hasMoved = true;
      isHorizontal = Math.abs(dx) > Math.abs(dy)*ANGLE_GUARD;
    }
    if(hasMoved && isHorizontal){
      if(evt && evt.cancelable) evt.preventDefault();  // block page scroll only during drag
      if(!isDragging){ isDragging=true; carousel.classList.add('dragging'); }
      let newX = -idx*slideW + dx;
      const maxX=0, minX=-(count-1)*slideW;
      if(newX>maxX) newX=maxX+(newX-maxX)*0.3;
      else if(newX<minX) newX=minX+(newX-minX)*0.3;
      carousel.style.transform = `translateX(${newX}px)`;
    }
  }
  function pointerUp(x){
    if(!isDragging){ isPointerDown=false; return; }
    const dx = (x ?? startX) - startX;
    const threshold = slideW * 0.25;
    let target = idx;
    if(Math.abs(dx)>threshold) target = dx>0 ? idx-1 : idx+1;

    isPointerDown=false; isDragging=false; hasMoved=false; isHorizontal=false;
    carousel.classList.remove('dragging');
    goTo(target);
  }

  // Mouse (require button held)
  viewport.addEventListener('mousedown', e=>pointerDown(e.clientX,e.clientY));
  document.addEventListener('mousemove', e=>{
    if(e.buttons!==1) return;                  // must be pressed
    pointerMove(e.clientX,e.clientY,e);
  }, {passive:false});
  document.addEventListener('mouseup',   e=>pointerUp(e.clientX));

  // Touch
  viewport.addEventListener('touchstart', e=>pointerDown(e.touches[0].clientX,e.touches[0].clientY), {passive:true});
  viewport.addEventListener('touchmove',  e=>pointerMove(e.touches[0].clientX,e.touches[0].clientY,e), {passive:false});
  viewport.addEventListener('touchend',   e=>pointerUp(e.changedTouches?.[0]?.clientX), {passive:true});

  // Buttons & keys
  prevBtn.onclick=()=>goTo(idx-1);
  nextBtn.onclick=()=>goTo(idx+1);
  document.addEventListener('keydown', e=>{
    if(!e.target.closest('.review')) return;
    if(e.key==='ArrowLeft'){ e.preventDefault(); goTo(idx-1); }
    if(e.key==='ArrowRight'){ e.preventDefault(); goTo(idx+1); }
  });

  // Auto-advance (pause on hover)
  let auto=setInterval(()=>goTo(idx<count-1?idx+1:0),8000);
  viewport.addEventListener('mouseenter', ()=>clearInterval(auto));
  viewport.addEventListener('mouseleave', ()=>auto=setInterval(()=>goTo(idx<count-1?idx+1:0),8000));

  // Init
  window.addEventListener('resize', ()=>{ recalc(); goTo(idx,false); });
  createDots(); recalc(); goTo(0,false);
})();
</script>

</body>
</html><section class="contact" id="Contact" aria-label="Contact Us">
  <div class="contact__wrap">
    <div class="contact__panel">

      <!-- Title -->
      <h2 class="contact__heading">Get in Touch</h2>

      <!-- Icons -->
      <div class="mini-icons">
        <div class="mini-pair">
          <a class="mini-icon" href="https://instagram.com/bajabelowsurface" aria-label="Instagram" target="_blank" rel="noopener">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
              <rect x="3" y="3" width="18" height="18" rx="5" ry="5"></rect>
              <circle cx="12" cy="12" r="4"></circle>
              <circle cx="17.5" cy="6.5" r="1"></circle>
            </svg>
          </a>
          <span class="contact__icon-text">@bajabelowsurface</span>
        </div>

        <div class="mini-pair">
          <a class="mini-icon" href="mailto:dani@bajabelowsurface.com" aria-label="Email">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
              <rect x="3" y="5" width="18" height="14" rx="2" ry="2"></rect>
              <path d="M3 7l9 6 9-6"></path>
            </svg>
          </a>
          <span class="contact__icon-text">dani@bajabelowsurface.com</span>
        </div>
      </div>

      <!-- Contact Form -->
      <form class="contact__form" action="<?php echo esc_url( admin_url('admin-post.php') ); ?>" method="post">
        <input type="hidden" name="action" value="cf7_submit">
        <input type="text" name="your-name" placeholder="Your Name" class="contact__input" required>
        <input type="email" name="your-email" placeholder="Your Email" class="contact__input" required>
        <textarea name="your-message" placeholder="Your Message" class="contact__textarea" required></textarea>
        <button type="submit" class="contact__btn">SEND MESSAGE</button>
      </form>

    </div>
  </div>
</section>
<!-- WhatsApp Floating Button -->
<a
  href="https://wa.me/526242104724"
  class="whatsapp-button"
  target="_blank"
  aria-label="Chat on WhatsApp"
>
  <img
    src="https://www.svgrepo.com/show/303280/whatsapp-glyph-black-logo.svg"
    alt="WhatsApp"
    style="width:2rem;height:2rem;display:block;"
  />
</a>
<script>
document.addEventListener('scroll',function(){
  document.body.classList.toggle('scrolled', window.scrollY>10);
},{passive:true});
</script>
<!-- ===== Hamburger Menu (RESPONSIVE: titles perfectly centered; socials pinned bottom. Desktop keeps extra top padding.) ===== -->
<!-- Button -->
<button class="ham" id="ham" aria-label="Open menu" aria-controls="menu" aria-expanded="false">
  <span class="ham__icon" aria-hidden="true">
    <span class="ham__bar ham__bar--1"></span>
    <span class="ham__bar ham__bar--2"></span>
    <span class="ham__bar ham__bar--3"></span>
  </span>
</button>

<!-- Fullscreen Menu -->
<nav class="menu" id="menu" aria-hidden="true">
  <div class="menu__container">
    <!-- CENTERED TITLES AREA -->
    <div class="menu__center">
      <ul class="menu__list" role="menu" aria-label="Main menu">
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/" style="--delay:.00s">Home</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1215" style="--delay:.08s">Day Trips</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1384" style="--delay:.16s">Expeditions</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1386" style="--delay:.24s">Charter</a></li>
        <li role="none"><a class="menu__link" role="menuitem" href="https://bajabelowsurface.com/?page_id=1397" style="--delay:.32s">About Us</a></li>
      </ul>
    </div>

    <!-- SOCIALS AT BOTTOM -->
    <div class="mini-icons">
      <div class="mini-pair">
        <a class="mini-icon" href="https://instagram.com/bajabelowsurface" aria-label="Instagram" target="_blank" rel="noopener">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
            <rect x="3" y="3" width="18" height="18" rx="5" ry="5"></rect>
            <circle cx="12" cy="12" r="4"></circle>
            <circle cx="17.5" cy="6.5" r="1"></circle>
          </svg>
        </a>
        <span class="contact__icon-text">@bajabelowsurface</span>
      </div>
      <div class="mini-pair">
        <a class="mini-icon" href="mailto:dani@bajabelowsurface.com" aria-label="Email">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" role="img" aria-hidden="true">
            <rect x="3" y="5" width="18" height="14" rx="2" ry="2"></rect>
            <path d="M3 7l9 6 9-6"></path>
          </svg>
        </a>
        <span class="contact__icon-text">dani@bajabelowsurface.com</span>
      </div>
    </div>
  </div>
</nav>

<script>
(function(){
  const btn = document.getElementById('ham');
  const menu = document.getElementById('menu');
  const links = menu.querySelectorAll('.menu__link');
  let lastFocus = null;

  // Ensure ONLY one active link
  const norm = (u)=>{ try{ const x=new URL(u, location.origin); return (x.origin+x.pathname+x.search).replace(/\/+$/,''); } catch(e){ return u; } };
  const here = norm(location.href);
  links.forEach(l => { l.classList.remove('is-active'); l.removeAttribute('aria-current'); });
  links.forEach(a => { if (norm(a.href) === here) { a.classList.add('is-active'); a.setAttribute('aria-current','page'); } });

  const lock = (on)=>{ document.documentElement.style.overflow = on ? 'hidden' : ''; };

  function openMenu(){
    lastFocus = document.activeElement;
    btn.setAttribute('aria-expanded','true');
    menu.classList.add('is-open');
    menu.removeAttribute('aria-hidden');
    lock(true);
    document.addEventListener('click', onAnyClick);
    document.addEventListener('keydown', onKey);
  }
  function closeMenu(){
    btn.setAttribute('aria-expanded','false');
    menu.classList.remove('is-open');
    menu.setAttribute('aria-hidden','true');
    lock(false);
    document.removeEventListener('click', onAnyClick);
    document.removeEventListener('keydown', onKey);
    if(lastFocus) lastFocus.focus();
  }
  function toggle(){ btn.getAttribute('aria-expanded')==='true' ? closeMenu() : openMenu(); }

  function onAnyClick(e){
    if (e.target===btn || btn.contains(e.target)) return;
    if (!menu.contains(e.target)) closeMenu();
  }
  function onKey(e){ if(e.key==='Escape') closeMenu(); }

  btn.addEventListener('click', e=>{ e.stopPropagation(); toggle(); });
  links.forEach(a => a.addEventListener('click', closeMenu));
})();
</script>
